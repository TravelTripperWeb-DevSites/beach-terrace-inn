diff --git a/_assets/image_data/ocean-front-king-premium.json b/_assets/image_data/ocean-front-king-premium.json
index 0ae2fd5..56b76c7 100644
--- a/_assets/image_data/ocean-front-king-premium.json
+++ b/_assets/image_data/ocean-front-king-premium.json
@@ -1,17 +1,17 @@
 {
-  "name": "ocean-front-king-premium",
-  "file_name": "ocean-front-king-premium.jpg",
+  "name": "Ocean-Front-King-Premium",
+  "file_name": "Ocean-Front-King-Premium.jpg",
   "file_type": "image/jpeg",
-  "url": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/ocean-front-king-premium.jpg",
+  "url": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/Ocean-Front-King-Premium.jpg",
   "tags": "gallery, rooms",
-  "file_size": 380737.0,
-  "width": 1600,
-  "height": 1067,
+  "file_size": 119137.0,
+  "width": 955,
+  "height": 666,
   "description": "",
-  "date_added": "2017-12-27-081939",
-  "url_large": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/large_ocean-front-king-premium.jpg",
-  "url_medium": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/medium_ocean-front-king-premium.jpg",
-  "url_small": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/small_ocean-front-king-premium.jpg",
-  "url_xsmall": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/xsmall_ocean-front-king-premium.jpg",
-  "url_thumb": "//cdn.traveltripper.io/site-assets/32_826_10537/media/2017-12-27-081939/thumb_ocean-front-king-premium.jpg"
+  "date_added": "2017-11-17-050131",
+  "url_large": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/large_Ocean-Front-King-Premium.jpg",
+  "url_medium": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/medium_Ocean-Front-King-Premium.jpg",
+  "url_small": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/small_Ocean-Front-King-Premium.jpg",
+  "url_xsmall": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/xsmall_Ocean-Front-King-Premium.jpg",
+  "url_thumb": "//cdn.traveltripper.io/site-assets/32_826_8939/media/2017-11-17-050131/thumb_Ocean-Front-King-Premium.jpg"
 }
\ No newline at end of file
diff --git a/_includes/scripts.html b/_includes/scripts.html
index 045fc74..9deb396 100644
--- a/_includes/scripts.html
+++ b/_includes/scripts.html
@@ -3,10 +3,11 @@
 {% endif %}
 
 {% include scripts/ipify.html %}
-
+<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.3/vue.js"></script>
+<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.js"></script>
 <script src="{{ '/assets/js/main.min.js' | absolute_url }}"></script>
 <!-- plugin booking widget -->
-<script src="https://plugins.traveltripper.io/v2/rt3api.min.js"></script>
+<script src="https://plugins.traveltripper.io/v2/rt3api.js"></script>
 <script src="https://plugins.traveltripper.io/v2/jquery.ttweb.js"></script>
 <script>
   TTWeb.Config.configure({
@@ -25,7 +26,7 @@
   // remove target attr of booking widget form to open it in same window.
   $(".ttweb-booking-widget form").removeAttr('target');
 
- 
+
 
 </script>
 
@@ -35,3 +36,5 @@
 <!-- Placed at the end of the document so the pages load faster -->
 <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
 <script src="{{ '/assets/js/ie10-viewport-bug-workaround.js' | absolute_url }}"></script>
+
+<!-- <script src="/assets/js/app.js"></script> -->
diff --git a/_sass/_brg.scss b/_sass/_brg.scss
index 372f7fa..b643acb 100644
--- a/_sass/_brg.scss
+++ b/_sass/_brg.scss
@@ -1,51 +1,358 @@
-.caption-price {
+// .price-wrap {
+//   bottom: 15%;
+//   left: 0;
+//   right: 0;
+//   margin: 0 auto;
+//   font-family: $global-font-family;
+//   z-index: 100;
+//   @media (max-width: 768px) {
+//     bottom: 0;
+//   }
+//   @media (min-width: 768px) {
+//     position: absolute;
+//   }
+//
+//   .best-rate-ota {
+//     box-shadow: 0 2px 2px 0 rgba(0,0,0,.14), 0 3px 1px -2px rgba(0,0,0,.2), 0 1px 5px 0 rgba(0,0,0,.12);
+//     max-width: 680px;
+//     width: 100%;
+//     min-height: 80px;
+//     left: calc(50% - 300px);
+//     display: table;
+//     background: $black;
+//     margin: 0 auto;
+//     @media(max-width: 767px) {
+//       width: 100%;
+//       bottom: 0;
+//     }
+//
+//     .boxes {
+//       position: relative;
+//
+//       .tonight-rate {
+//         height: 100%;
+//         width: 38%;
+//         min-height: 80px;
+//         padding: 10px 20px;
+//         float: left;
+//
+//         p {
+//           font-size: 12px;
+//           color: #777777;
+//           line-height: 16px;
+//           margin: 0;
+//           padding: 0;
+//           text-align: left;
+//           @media(max-width:350px) {
+//             display: none;
+//           }
+//         }
+//
+//         h4 {
+//           font-size: 16px;
+//           line-height: 30px;
+//           margin: 0;
+//           padding: 0;
+//           text-align: left;
+//           color: $white;
+//
+//           .price {
+//             color: $white;
+//             font-size: 30px;
+//             float: right;
+//             @media(max-width:350px) {
+//               display: inline-block;
+//               float: none;
+//               margin-top: 10px;
+//             }
+//           }
+//           @media(max-width:350px) {
+//             line-height: 20px;
+//           }
+//         }
+//       }
+//
+//       .ota-list {
+//         float: right;
+//         width: 61.7%;
+//         min-height: 80px;
+//         padding: 10px 20px;
+//         border-left: 1px solid $background-color;
+//
+//         ul {
+//           width: 100%;
+//           padding: 0;
+//           list-style-type: none;
+//
+//           li {
+//             display: inline-block;
+//             width: 45%;
+//             // padding: 0 10px 0 0;
+//             margin: 3px;
+//             padding: 2px;
+//             font-size: 15px;
+//             color: $background-color;
+//             border-bottom: 1px solid $background-color;
+//
+//             span {
+//               padding-left: 4px;
+//               text-decoration: line-through;
+//               color: $white;
+//             }
+//
+//             &:nth-child(even) {
+//               margin-left: 20px;
+//               @media(max-width: 768px) {
+//                 margin: 0;
+//               }
+//             }
+//             @media(max-width: 768px) {
+//               width: inherit;
+//             }
+//           }
+//         }
+//       }
+//     }
+//   }
+// }
+//
+// .caption-price {
+//   right: 0;
+//   bottom: 0;
+//   left: 0;
+//   z-index: 100;
+//   display: none;
+//   text-align: center;
+//   text-transform: none;
+//   @media(max-width: 767px) {
+//     bottom: 0;
+//     background-color: $black;
+//     border-bottom: 1px solid #777;
+//   }
+//   @media (min-width: 768px) {
+//     position: absolute;
+//   }
+// }
+//
+// .price-holder {
+//   display: inline-block;
+//   margin-right: -2px;
+//   padding: 8px 20px;
+//   font-family: $global-font-family;
+//   font-size: 18px;
+//   color: $white;
+//   letter-spacing: 1px;
+//   vertical-align: middle;
+//   background-color: $black;
+//   @media (max-width: 1023px) {
+//     padding: 6px 10px;
+//     font-size: 11px;
+//   }
+//
+//   span {
+//     padding-right: 18px;
+//     font-size: 30px;
+//     color: $white;
+//     vertical-align: middle;
+//     @media (max-width: 1023px) {
+//       padding-right: 8px;
+//       font-size: 25px;
+//     }
+//   }
+//   @media(max-width: 768px) {
+//     &.tonight {
+//       margin-top: 1px;
+//     }
+//   }
+// }
+
+
+
+
+.homeBannerWidget {
   right: 0;
-  bottom: 0;
+  bottom: 3px;
   left: 0;
-  z-index: 100;
-  display: none;
-  text-align: center;
-  text-transform: none;
+  z-index: 10;
   @media(max-width: 767px) {
     bottom: 0;
-    background-color: $black;
-    border-bottom: 1px solid #777;
-	}
-  @media (min-width: 768px) {
+  }
+  @media (min-width: 767px) {
     position: absolute;
   }
-}
-.price-holder{
-  display: inline-block;
-  margin-right: -2px;
-  padding: 8px 20px;
-  font-family: $global-font-family;
-  font-size: 18px;
-  color: $white;
-  letter-spacing: 1px;
-  vertical-align: middle;
-  background-color: $black;
-
-  @media (max-width: 1023px) {
-    padding: 6px 10px;
-    font-size: 11px;
+  .scarcity-price {
+    display: none;
+    text-align: center;
+    text-transform: none;
+
+    // @media(min-width: 768px) {
+    //   margin-bottom: 30px;
+    // }
   }
 
-	span{
-    padding-right: 18px;
-    font-size: 30px;
+  .price-holder,
+  .scarcity-holder {
+    display: inline-block;
+    margin-right: -2px;
+    padding: 1px 20px;
+    font-family: 'Bryant Pro Regular';
+    font-size: 15px;
     color: $white;
+    letter-spacing: 1px;
     vertical-align: middle;
-
+    background-color: $black;
     @media (max-width: 1023px) {
-      padding-right: 8px;
-      font-size: 25px;
+      padding: 6px 10px;
+      font-size: 14px;
     }
-	}
-  @media(max-width: 768px) {
-    &.tonight {
-      margin-top: 1px;
+
+    span {
+      padding-right: 18px;
+      font-size: 30px;
+      font-weight: bold;
+      color: $white;
+      vertical-align: middle;
+      @media (max-width: 1023px) {
+        padding-right: 8px;
+        font-size: 25px;
+      }
+    }
+    @media(max-width: 767px) {
+      &.tonight {
+        display: none;
+      }
+    }
+    .tonightPrice {
+      font-family: 'Domaine Disp Extrabold';
+      font-size: 30px;
+      font-style: italic;
+      color: $white;
     }
   }
 
+  .brg-price {
+
+    display: none;
+    // margin: 0 auto;
+    margin-bottom: 22px;
+    font-family: 'Bryant Pro Regular';
+    @media(max-width: 768px) {
+      margin-bottom: 1px;
+      //border-bottom: 1px solid #ccc;
+  	}
+
+    .best-rate-ota {
+      left: calc(50% - 300px);
+      display: table;
+      width: 100%;
+      max-width: 660px;
+      min-height: 80px;
+      margin: 0 auto;
+      background: $black;
+      color: $white;
+      // box-shadow: 0 2px 2px 0 rgba(0,0,0,.14), 0 3px 1px -2px rgba(0,0,0,.2), 0 1px 5px 0 rgba(0,0,0,.12);
+      @media(max-width: 768px) {
+        bottom: 0;
+        width: 100%;
+      }
+
+      .boxes {
+        position: relative;
+
+        .brg-tonight-rate {
+          float: left;
+          width: 38%;
+          height: 100%;
+          min-height: 80px;
+          padding: 16px;
+
+          p {
+            margin: 0;
+            padding: 0;
+            font-size: 12px;
+            line-height: 10px;
+            color: #777;
+            text-align: left;
+            @media(max-width: 350px) {
+              display: none;
+            }
+          }
+
+          h4 {
+            margin: 0;
+            padding: 0;
+            font-family: 'Bryant Pro Bold';
+            font-size: 18px;
+            line-height: 30px;
+            color: #fff;
+            text-align: left;
+            text-transform: none;
+            letter-spacing: .01em;
+
+            .price {
+              float: right;
+              font-family: 'Domaine Disp Extrabold';
+              font-size: 30px;
+              font-style: italic;
+              color: $white;
+              p {
+                margin-top: 1px;
+                font-style: normal;
+                text-align: center;
+              }
+              @media(max-width: 350px) {
+                display: inline-block;
+                float: none;
+                margin-top: 10px;
+              }
+            }
+            @media(max-width: 350px) {
+              line-height: 20px;
+            }
+          }
+        }
+
+        .ota-list {
+          float: right;
+          width: 61.7%;
+          min-height: 80px;
+          padding: 12px 20px;
+          border-left: 1px solid #ccc;
+
+          ul {
+            width: 100%;
+            margin-bottom: 0;
+            padding: 0;
+            list-style-type: none;
+
+            li {
+              display: inline-block;
+              width: 45%;
+              margin: 0;
+              padding: 0 10px 0 0;
+              font-size: 16px;
+              color: $white;;
+              border-bottom: 1px solid #ccc;
+
+              span {
+                padding-left: 4px;
+                //color: #280071;
+                text-decoration: line-through;
+              }
+
+              &:nth-child(even) {
+                margin-left: 20px;
+                @media(max-width: 768px) {
+                  margin: 0;
+                }
+              }
+              @media(max-width: 768px) {
+                width: inherit;
+              }
+            }
+          }
+        }
+      }
+    }
+  }
 }
diff --git a/assets/js/_main.js b/assets/js/_main.js
index 4207658..94b3624 100644
--- a/assets/js/_main.js
+++ b/assets/js/_main.js
@@ -101,7 +101,7 @@ $(document).ready(function() {
 
           ]
         });
-        $(".caption-price").show();
+        $(".scarcity-price, .brg-price").show();
     },3100);
 
     //Attraction information
diff --git a/assets/js/main.min.js b/assets/js/main.min.js
index d9210fb..3e3adc1 100644
--- a/assets/js/main.min.js
+++ b/assets/js/main.min.js
@@ -18,5 +18,5 @@ height:i.size.height-a},l=parseFloat(i.element.css("left"))+(i.position.left-i.o
 this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(s).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){i._rendered||i._refreshMenu()})},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var s=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger("focus",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr("aria-activedescendant",e.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var i=t("<span>");return this._setText(i,e.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(e,i){var s=this,n="";t.each(i,function(i,o){var a;o.optgroup!==n&&(a=t("<li>",{text:o.optgroup}),s._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(e),n=o.optgroup),s._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var s=t("<li>"),n=t("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(s,null,"ui-state-disabled"),this._setText(n,i.label),s.append(n).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),n+=":not(.ui-state-disabled)"),s="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](n).eq(-1):i[t+"All"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;return!1===t?void this.button.css("width",""):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),void this.button.outerWidth(t))},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var i=this,s=[];e.each(function(e,n){s.push(i._parseOption(t(n),e))}),this.items=s},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle"),a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push("<span tabindex='0'></span>");this.handles=n.add(t(a.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===e.range||"max"===e.range)&&this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,h,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),!1!==this._start(e,a)&&(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),h=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-o.width()/2,top:e.pageY-h.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_uiHash:function(t,e,i){var s={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(s.value=void 0!==e?e:this.values(t),s.values=i||this.values()),s},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var n,o=this.value(),a=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),o=this.values(e),2===this.options.values.length&&!0===this.options.range&&(i=0===e?Math.min(n,i):Math.max(n,i)),a[e]=i),i!==o&&!1!==this._trigger("slide",t,this._uiHash(e,i,a))&&(this._hasMultipleValues()?this.values(e,i):this.value(i))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),this._super(e,i),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=n-1;s>=0;s--)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;t=Math.round((t-e)/i)*i+e,t>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,h=this,l=!this._animateOff&&r.animate,c={};this._hasMultipleValues()?this.handles.each(function(s){i=(h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())*100,c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,r.animate),!0===h.options.range&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?(s-n)/(o-n)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},r.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},r.animate))},_handleEvents:{keydown:function(e){var s,n,o,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),!1===this._start(e,a)))return}switch(o=this.options.step,s=n=this._hasMultipleValues()?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-o)}this._slide(e,a,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),!!s&&(!(this.options.handle&&!i&&(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),!n))&&(this.currentItem=s,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),!1!==r&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],(o=this._intersectsWithPointer(s))&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],n))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!(!s||!n)&&(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],h=[],l=this._connectWith();if(l&&e)for(s=l.length-1;s>=0;s--)for(o=t(l[s],this.document[0]),n=o.length-1;n>=0;n--)(a=t.data(o[n],this.widgetFullName))&&a!==this&&!a.options.disabled&&h.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(h.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)(o=t.data(n[s],this.widgetFullName))&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",a),c.push({item:h,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),
 "tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,h,l,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[a],l=!1,e[u]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(e[u]-h)&&(n=Math.abs(e[u]-h),o=this.items[s],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e=this._super(),i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);null!=n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){this.element[0]===t.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===t.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),!1!==this._start(e)&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?!1!==this._start(e)&&void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var i,s,n;return"culture"===t||"numberFormat"===t?(i=this._parse(this.element.val()),this.options[t]=e,void this.element.val(this._format(i))):(("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(s=this.buttons.first().find(".ui-icon"),this._removeClass(s,null,this.options.icons.up),this._addClass(s,null,e.up),n=this.buttons.last().find(".ui-icon"),this._removeClass(n,null,this.options.icons.down),this._addClass(n,null,e.down)),void this._super(t,e))},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:r(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i)),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:r(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:r(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:r(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:r(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void r(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),!1!==t.uiBackCompat&&t.widget("ui.spinner",t.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),t.ui.spinner,t.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var t=/#.*$/;return function(e){var i,s;i=e.href.replace(t,""),s=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return e.hash.length>1&&i===s}}(),_create:function(){var e=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===e&&(s&&this.tabs.each(function(i,n){return t(n).attr("aria-controls")===s?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(t.ui.safeActiveElement(this.document[0])).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s!==this.options.active&&s);default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||e.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){for(var n=this.tabs.length-1;-1!==t.inArray(function(){return e>n&&(e=0),0>e&&(e=n),e}(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){return"active"===t?void this._activate(e):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=t(),this.anchors.each(function(i,s){var n,o,a,r=t(s).uniqueId().attr("id"),h=t(s).closest("li"),l=h.attr("aria-controls");e._isLocal(s)?(n=s.hash,a=n.substring(1),o=e.element.find(e._sanitizeSelector(n))):(a=h.attr("aria-controls")||t({}).uniqueId()[0].id,n="#"+a,o=e.element.find(n),o.length||(o=e._createPanel(a),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":a,"aria-labelledby":r}),o.attr("aria-labelledby",r)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(e){var i,s,n;for(t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1),n=0;s=this.tabs[n];n++)i=t(s),!0===e||-1!==t.inArray(n,e)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=e,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===e)},_setupEvents:function(e){var i={};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n.closest("li"),a=o[0]===s[0],r=a&&i.collapsible,h=r?t():this._getPanelForTab(o),l=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:l,newTab:r?t():o,newPanel:h};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||a&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!r&&this.tabs.index(o),this.active=a?t():o,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function s(){o.running=!1,o._trigger("activate",e,i)}function n(){o._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),a.length&&o.options.show?o._show(a,o.options.show,s):(a.show(),s())}var o=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){o._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),n()}):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),a.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+t.ui.escapeSelector(e)+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var i=this.options.disabled;!1!==i&&(void 0===e?i=!1:(e=this._getIndex(e),i=t.isArray(i)?t.map(i,function(t){return t!==e?t:null}):t.map(this.tabs,function(t,i){return i!==e?i:null})),this._setOptionDisabled(i))},disable:function(e){var i=this.options.disabled;if(!0!==i){if(void 0===e)i=!0;else{if(e=this._getIndex(e),-1!==t.inArray(e,i))return;i=t.isArray(i)?t.merge([e],i).sort():[e]}this._setOptionDisabled(i)}},load:function(e,i){e=this._getIndex(e);var s=this,n=this.tabs.eq(e),o=n.find(".ui-tabs-anchor"),a=this._getPanelForTab(n),r={tab:n,panel:a},h=function(t,e){"abort"===e&&s.panels.stop(!1,!0),s._removeClass(n,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===s.xhr&&delete s.xhr};this._isLocal(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(n,"ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.done(function(t,e,n){setTimeout(function(){a.html(t),s._trigger("load",i,r),h(n,e)},1)}).fail(function(t,e){setTimeout(function(){h(t,e)},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href").replace(/#.*$/,""),beforeSend:function(e,o){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:o},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),!1!==t.uiBackCompat&&t.widget("ui.tabs",t.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),t.ui.tabs,t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,i){var s=this;this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s.element[0],e.close(n,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=t(this);return e.is("[title]")?e.data("ui-tooltip-title",e.attr("title")).removeAttr("title"):void 0}))},_enable:function(){this.disabledTitles.each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))}),this.disabledTitles=t([])},open:function(e){
 var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(e,s),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,o=e?e.type:null;return"string"==typeof s||s.nodeType||s.jquery?this._open(e,t,s):void((i=s.call(t[0],function(i){n._delay(function(){t.data("ui-tooltip-open")&&(e&&(e.type=o),this._open(e,t,i))})}))&&this._open(e,t,i))},_open:function(e,i,s){function n(t){l.of=t,a.is(":hidden")||a.position(l)}var o,a,r,h,l=t.extend({},this.options.position);if(s){if(o=this._find(i))return void o.tooltip.find(".ui-tooltip-content").html(s);i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),a=o.tooltip,this._addDescribedBy(i,a.attr("id")),a.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),h=t("<div>").html(a.find(".ui-tooltip-content").html()),h.removeAttr("name").find("[name]").removeAttr("name"),h.removeAttr("id").find("[id]").removeAttr("id"),h.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):a.position(t.extend({of:i},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(":visible")&&(n(l.of),clearInterval(r))},t.fx.interval)),this._trigger("open",e,{tooltip:a})}},_registerCloseHandlers:function(e,i){var s={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var s=t.Event(e);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(s.mouseleave="close"),e&&"focusin"!==e.type||(s.focusout="close"),this._on(!0,i,s)},close:function(e){var i,s=this,n=t(e?e.currentTarget:this.element),o=this._find(n);return o?(i=o.tooltip,void(o.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),o.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),o.closing=!0,this._trigger("close",e,{tooltip:i}),o.hiding||(o.closing=!1)))):void n.removeData("ui-tooltip-open")},_tooltip:function(e){var i=t("<div>").attr("role","tooltip"),s=t("<div>").appendTo(i),n=i.uniqueId().attr("id");return this._addClass(s,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(e)),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur"),o=s.element;n.target=n.currentTarget=o[0],e.close(n,!0),t("#"+i).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==t.uiBackCompat&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip}),function(e,t,i){"use strict";function o(t,o){if(this.el=t,this.$el=e(t),this.s=e.extend({},s,o),this.s.dynamic&&"undefined"!==this.s.dynamicEl&&this.s.dynamicEl.constructor===Array&&!this.s.dynamicEl.length)throw"When using dynamic mode, you must also define dynamicEl as an Array.";return this.modules={},this.lGalleryOn=!1,this.lgBusy=!1,this.hideBartimeout=!1,this.isTouch="ontouchstart"in i.documentElement,this.s.slideEndAnimatoin&&(this.s.hideControlOnEnd=!1),this.s.dynamic?this.$items=this.s.dynamicEl:"this"===this.s.selector?this.$items=this.$el:""!==this.s.selector?this.s.selectWithin?this.$items=e(this.s.selectWithin).find(this.s.selector):this.$items=this.$el.find(e(this.s.selector)):this.$items=this.$el.children(),this.$slide="",this.$outer="",this.init(),this}var s={mode:"lg-slide",cssEasing:"cubic-bezier(0.25, 0, 0.25, 1)",easing:"linear",speed:600,height:"100%",width:"100%",addClass:"",startClass:"lg-start-zoom",backdropDuration:150,hideBarsDelay:6e3,useLeft:!1,closable:!0,loop:!0,escKey:!0,keyPress:!0,controls:!0,slideEndAnimatoin:!0,hideControlOnEnd:!1,mousewheel:!0,appendSubHtmlTo:".lg-sub-html",preload:1,showAfterLoad:!0,selector:"",selectWithin:"",nextHtml:"",prevHtml:"",index:!1,iframeMaxWidth:"100%",download:!1,counter:!0,appendCounterTo:".lg-toolbar",swipeThreshold:50,enableSwipe:!0,enableDrag:!0,dynamic:!1,dynamicEl:[],galleryId:1};o.prototype.init=function(){var i=this;i.s.preload>i.$items.length&&(i.s.preload=i.$items.length);var o=t.location.hash;o.indexOf("lg="+this.s.galleryId)>0&&(i.index=parseInt(o.split("&slide=")[1],10),e("body").addClass("lg-from-hash"),e("body").hasClass("lg-on")||setTimeout(function(){i.build(i.index),e("body").addClass("lg-on")})),i.s.dynamic?(i.$el.trigger("onBeforeOpen.lg"),i.index=i.s.index||0,e("body").hasClass("lg-on")||setTimeout(function(){i.build(i.index),e("body").addClass("lg-on")})):i.$items.on("click.lgcustom",function(t){try{t.preventDefault(),t.preventDefault()}catch(e){t.returnValue=!1}i.$el.trigger("onBeforeOpen.lg"),i.index=i.s.index||i.$items.index(this),e("body").hasClass("lg-on")||(i.build(i.index),e("body").addClass("lg-on"))})},o.prototype.build=function(t){var i=this;i.structure(),e.each(e.fn.lightGallery.modules,function(t){i.modules[t]=new e.fn.lightGallery.modules[t](i.el)}),i.slide(t,!1,!1),i.s.keyPress&&i.keyPress(),i.$items.length>1&&(i.arrow(),setTimeout(function(){i.enableDrag(),i.enableSwipe()},50),i.s.mousewheel&&i.mousewheel()),i.counter(),i.closeGallery(),i.$el.trigger("onAfterOpen.lg"),i.$outer.on("mousemove.lg click.lg touchstart.lg",function(){i.$outer.removeClass("lg-hide-items"),clearTimeout(i.hideBartimeout),i.hideBartimeout=setTimeout(function(){i.$outer.addClass("lg-hide-items")},i.s.hideBarsDelay)})},o.prototype.structure=function(){var i,o="",s="",r=0,a="",l=this;for(e("body").append('<div class="lg-backdrop"></div>'),e(".lg-backdrop").css("transition-duration",this.s.backdropDuration+"ms"),r=0;r<this.$items.length;r++)o+='<div class="lg-item"></div>';if(this.s.controls&&this.$items.length>1&&(s='<div class="lg-actions"><div class="lg-prev lg-icon">'+this.s.prevHtml+'</div><div class="lg-next lg-icon">'+this.s.nextHtml+"</div></div>"),".lg-sub-html"===this.s.appendSubHtmlTo&&(a='<div class="lg-sub-html"></div>'),i='<div class="lg-outer '+this.s.addClass+" "+this.s.startClass+'"><div class="lg" style="width:'+this.s.width+"; height:"+this.s.height+'"><div class="lg-inner">'+o+'</div><div class="lg-toolbar group"><span class="lg-close lg-icon"></span></div>'+s+a+"</div></div>",e("body").append(i),this.$outer=e(".lg-outer"),this.$slide=this.$outer.find(".lg-item"),this.s.useLeft?(this.$outer.addClass("lg-use-left"),this.s.mode="lg-slide"):this.$outer.addClass("lg-use-css3"),l.setTop(),e(t).on("resize.lg orientationchange.lg",function(){setTimeout(function(){l.setTop()},100)}),this.$slide.eq(this.index).addClass("lg-current"),this.doCss()?this.$outer.addClass("lg-css3"):(this.$outer.addClass("lg-css"),this.s.speed=0),this.$outer.addClass(this.s.mode),this.s.enableDrag&&this.$items.length>1&&this.$outer.addClass("lg-grab"),this.s.showAfterLoad&&this.$outer.addClass("lg-show-after-load"),this.doCss()){var n=this.$outer.find(".lg-inner");n.css("transition-timing-function",this.s.cssEasing),n.css("transition-duration",this.s.speed+"ms")}e(".lg-backdrop").addClass("in"),setTimeout(function(){l.$outer.addClass("lg-visible")},this.s.backdropDuration),this.s.download&&this.$outer.find(".lg-toolbar").append('<a id="lg-download" target="_blank" download class="lg-download lg-icon"></a>'),this.prevScrollTop=e(t).scrollTop()},o.prototype.setTop=function(){if("100%"!==this.s.height){var i=e(t).height(),o=(i-parseInt(this.s.height,10))/2,s=this.$outer.find(".lg");i>=parseInt(this.s.height,10)?s.css("top",o+"px"):s.css("top","0px")}},o.prototype.doCss=function(){return!!function(){var e=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"],t=i.documentElement,o=0;for(o=0;o<e.length;o++)if(e[o]in t.style)return!0}()},o.prototype.isVideo=function(e,t){var i;if(i=this.s.dynamic?this.s.dynamicEl[t].html:this.$items.eq(t).attr("data-html"),!e&&i)return{html5:!0};var o=e.match(/\/\/(?:www\.)?youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9\-\_\%]+)/i),s=e.match(/\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i),r=e.match(/\/\/(?:www\.)?dai.ly\/([0-9a-z\-_]+)/i);return o?{youtube:o}:s?{vimeo:s}:r?{dailymotion:r}:void 0},o.prototype.counter=function(){this.s.counter&&e(this.s.appendCounterTo).append('<div id="lg-counter"><span id="lg-counter-current">'+(parseInt(this.index,10)+1)+'</span> / <span id="lg-counter-all">'+this.$items.length+"</span></div>")},o.prototype.addHtml=function(t){var i,o=null;if(this.s.dynamic?this.s.dynamicEl[t].subHtmlUrl?i=this.s.dynamicEl[t].subHtmlUrl:o=this.s.dynamicEl[t].subHtml:this.$items.eq(t).attr("data-sub-html-url")?i=this.$items.eq(t).attr("data-sub-html-url"):o=this.$items.eq(t).attr("data-sub-html"),!i)if(void 0!==o&&null!==o){var s=o.substring(0,1);o="."===s||"#"===s?e(o).html():o}else o="";".lg-sub-html"===this.s.appendSubHtmlTo?i?this.$outer.find(this.s.appendSubHtmlTo).load(i):this.$outer.find(this.s.appendSubHtmlTo).html(o):i?this.$slide.eq(t).load(i):this.$slide.eq(t).append(o),void 0!==o&&null!==o&&(""===o?this.$outer.find(this.s.appendSubHtmlTo).addClass("lg-empty-html"):this.$outer.find(this.s.appendSubHtmlTo).removeClass("lg-empty-html")),this.$el.trigger("onAfterAppendSubHtml.lg",[t])},o.prototype.preload=function(e){var t=1,i=1;for(t=1;t<=this.s.preload&&!(t>=this.$items.length-e);t++)this.loadContent(e+t,!1,0);for(i=1;i<=this.s.preload&&!(e-i<0);i++)this.loadContent(e-i,!1,0)},o.prototype.loadContent=function(i,o,s){var r,a,l,n,d,u,h=this,c=!1,g=function(i){for(var o=[],s=[],r=0;r<i.length;r++){var l=i[r].split(" ");""===l[0]&&l.splice(0,1),s.push(l[0]),o.push(l[1])}for(var n=e(t).width(),d=0;d<o.length;d++)if(parseInt(o[d],10)>n){a=s[d];break}};h.s.dynamic?(h.s.dynamicEl[i].poster&&(c=!0,l=h.s.dynamicEl[i].poster),u=h.s.dynamicEl[i].html,a=h.s.dynamicEl[i].src,h.s.dynamicEl[i].responsive&&g(h.s.dynamicEl[i].responsive.split(",")),n=h.s.dynamicEl[i].srcset,d=h.s.dynamicEl[i].sizes):(h.$items.eq(i).attr("data-poster")&&(c=!0,l=h.$items.eq(i).attr("data-poster")),u=h.$items.eq(i).attr("data-html"),a=h.$items.eq(i).attr("href")||h.$items.eq(i).attr("data-src"),h.$items.eq(i).attr("data-responsive")&&g(h.$items.eq(i).attr("data-responsive").split(",")),n=h.$items.eq(i).attr("data-srcset"),d=h.$items.eq(i).attr("data-sizes"));var m=!1;h.s.dynamic?h.s.dynamicEl[i].iframe&&(m=!0):"true"===h.$items.eq(i).attr("data-iframe")&&(m=!0);var f=h.isVideo(a,i);if(!h.$slide.eq(i).hasClass("lg-loaded")){if(m)h.$slide.eq(i).prepend('<div class="lg-video-cont" style="max-width:'+h.s.iframeMaxWidth+'"><div class="lg-video"><iframe class="lg-object" frameborder="0" src="'+a+'"  allowfullscreen="true"></iframe></div></div>');else if(c){var p="";p=f&&f.youtube?"lg-has-youtube":f&&f.vimeo?"lg-has-vimeo":"lg-has-html5",h.$slide.eq(i).prepend('<div class="lg-video-cont '+p+' "><div class="lg-video"><span class="lg-video-play"></span><img class="lg-object lg-has-poster" src="'+l+'" /></div></div>')}else f?(h.$slide.eq(i).prepend('<div class="lg-video-cont "><div class="lg-video"></div></div>'),h.$el.trigger("hasVideo.lg",[i,a,u])):h.$slide.eq(i).prepend('<div class="lg-img-wrap"><img class="lg-object lg-image" src="'+a+'" /></div>');if(h.$el.trigger("onAferAppendSlide.lg",[i]),r=h.$slide.eq(i).find(".lg-object"),d&&r.attr("sizes",d),n){r.attr("srcset",n);try{picturefill({elements:[r[0]]})}catch(e){console.error("Make sure you have included Picturefill version 2")}}".lg-sub-html"!==this.s.appendSubHtmlTo&&h.addHtml(i),h.$slide.eq(i).addClass("lg-loaded")}h.$slide.eq(i).find(".lg-object").on("load.lg error.lg",function(){var t=0;s&&!e("body").hasClass("lg-from-hash")&&(t=s),setTimeout(function(){h.$slide.eq(i).addClass("lg-complete"),h.$el.trigger("onSlideItemLoad.lg",[i,s||0])},t)}),f&&f.html5&&!c&&h.$slide.eq(i).addClass("lg-complete"),!0===o&&(h.$slide.eq(i).hasClass("lg-complete")?h.preload(i):h.$slide.eq(i).find(".lg-object").on("load.lg error.lg",function(){h.preload(i)}))},o.prototype.slide=function(t,i,o){var s=this.$outer.find(".lg-current").index(),r=this;if(!r.lGalleryOn||s!==t){var a=this.$slide.length,l=r.lGalleryOn?this.s.speed:0,n=!1,d=!1;if(!r.lgBusy){if(this.s.download){var u;u=r.s.dynamic?!1!==r.s.dynamicEl[t].downloadUrl&&(r.s.dynamicEl[t].downloadUrl||r.s.dynamicEl[t].src):"false"!==r.$items.eq(t).attr("data-download-url")&&(r.$items.eq(t).attr("data-download-url")||r.$items.eq(t).attr("href")||r.$items.eq(t).attr("data-src")),u?(e("#lg-download").attr("href",u),r.$outer.removeClass("lg-hide-download")):r.$outer.addClass("lg-hide-download")}if(this.$el.trigger("onBeforeSlide.lg",[s,t,i,o]),r.lgBusy=!0,clearTimeout(r.hideBartimeout),".lg-sub-html"===this.s.appendSubHtmlTo&&setTimeout(function(){r.addHtml(t)},l),this.arrowDisable(t),i){var h=t-1,c=t+1;0===t&&s===a-1?(c=0,h=a-1):t===a-1&&0===s&&(c=0,h=a-1),this.$slide.removeClass("lg-prev-slide lg-current lg-next-slide"),r.$slide.eq(h).addClass("lg-prev-slide"),r.$slide.eq(c).addClass("lg-next-slide"),r.$slide.eq(t).addClass("lg-current")}else r.$outer.addClass("lg-no-trans"),this.$slide.removeClass("lg-prev-slide lg-next-slide"),t<s?(d=!0,0!==t||s!==a-1||o||(d=!1,n=!0)):t>s&&(n=!0,t!==a-1||0!==s||o||(d=!0,n=!1)),d?(this.$slide.eq(t).addClass("lg-prev-slide"),this.$slide.eq(s).addClass("lg-next-slide")):n&&(this.$slide.eq(t).addClass("lg-next-slide"),this.$slide.eq(s).addClass("lg-prev-slide")),setTimeout(function(){r.$slide.removeClass("lg-current"),r.$slide.eq(t).addClass("lg-current"),r.$outer.removeClass("lg-no-trans")},50);r.lGalleryOn?(setTimeout(function(){r.loadContent(t,!0,0)},this.s.speed+50),setTimeout(function(){r.lgBusy=!1,r.$el.trigger("onAfterSlide.lg",[s,t,i,o])},this.s.speed)):(r.loadContent(t,!0,r.s.backdropDuration),r.lgBusy=!1,r.$el.trigger("onAfterSlide.lg",[s,t,i,o])),r.lGalleryOn=!0,this.s.counter&&e("#lg-counter-current").text(t+1)}}},o.prototype.goToNextSlide=function(e){var t=this;t.lgBusy||(t.index+1<t.$slide.length?(t.index++,t.$el.trigger("onBeforeNextSlide.lg",[t.index]),t.slide(t.index,e,!1)):t.s.loop?(t.index=0,t.$el.trigger("onBeforeNextSlide.lg",[t.index]),t.slide(t.index,e,!1)):t.s.slideEndAnimatoin&&(t.$outer.addClass("lg-right-end"),setTimeout(function(){t.$outer.removeClass("lg-right-end")},400)))},o.prototype.goToPrevSlide=function(e){var t=this;t.lgBusy||(t.index>0?(t.index--,t.$el.trigger("onBeforePrevSlide.lg",[t.index,e]),t.slide(t.index,e,!1)):t.s.loop?(t.index=t.$items.length-1,t.$el.trigger("onBeforePrevSlide.lg",[t.index,e]),t.slide(t.index,e,!1)):t.s.slideEndAnimatoin&&(t.$outer.addClass("lg-left-end"),setTimeout(function(){t.$outer.removeClass("lg-left-end")},400)))},o.prototype.keyPress=function(){var i=this;this.$items.length>1&&e(t).on("keyup.lg",function(e){i.$items.length>1&&(37===e.keyCode&&(e.preventDefault(),i.goToPrevSlide()),39===e.keyCode&&(e.preventDefault(),i.goToNextSlide()))}),e(t).on("keydown.lg",function(e){!0===i.s.escKey&&27===e.keyCode&&(e.preventDefault(),i.$outer.hasClass("lg-thumb-open")?i.$outer.removeClass("lg-thumb-open"):i.destroy())})},o.prototype.arrow=function(){var e=this;this.$outer.find(".lg-prev").on("click.lg",function(){e.goToPrevSlide()}),this.$outer.find(".lg-next").on("click.lg",function(){e.goToNextSlide()})},o.prototype.arrowDisable=function(e){!this.s.loop&&this.s.hideControlOnEnd&&(e+1<this.$slide.length?this.$outer.find(".lg-next").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-next").attr("disabled","disabled").addClass("disabled"),e>0?this.$outer.find(".lg-prev").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-prev").attr("disabled","disabled").addClass("disabled"))},o.prototype.setTranslate=function(e,t,i){this.s.useLeft?e.css("left",t):e.css({transform:"translate3d("+t+"px, "+i+"px, 0px)"})},o.prototype.touchMove=function(t,i){var o=i-t;this.$outer.addClass("lg-dragging"),this.setTranslate(this.$slide.eq(this.index),o,0),this.setTranslate(e(".lg-prev-slide"),-this.$slide.eq(this.index).width()+o,0),this.setTranslate(e(".lg-next-slide"),this.$slide.eq(this.index).width()+o,0)},o.prototype.touchEnd=function(e){var t=this;"lg-slide"!==t.s.mode&&t.$outer.addClass("lg-slide"),this.$slide.not(".lg-current, .lg-prev-slide, .lg-next-slide").css("opacity","0"),setTimeout(function(){t.$outer.removeClass("lg-dragging"),e<0&&Math.abs(e)>t.s.swipeThreshold?t.goToNextSlide(!0):e>0&&Math.abs(e)>t.s.swipeThreshold?t.goToPrevSlide(!0):Math.abs(e)<5&&t.$el.trigger("onSlideClick.lg"),t.$slide.removeAttr("style")}),setTimeout(function(){t.$outer.hasClass("lg-dragging")||"lg-slide"===t.s.mode||t.$outer.removeClass("lg-slide")},t.s.speed+100)},o.prototype.enableSwipe=function(){var e=this,t=0,i=0,o=!1;e.s.enableSwipe&&e.isTouch&&e.doCss()&&(e.$slide.on("touchstart.lg",function(i){e.$outer.hasClass("lg-zoomed")||e.lgBusy||(i.preventDefault(),e.manageSwipeClass(),t=i.originalEvent.targetTouches[0].pageX)}),e.$slide.on("touchmove.lg",function(s){e.$outer.hasClass("lg-zoomed")||(s.preventDefault(),i=s.originalEvent.targetTouches[0].pageX,e.touchMove(t,i),o=!0)}),e.$slide.on("touchend.lg",function(){e.$outer.hasClass("lg-zoomed")||(o?(o=!1,e.touchEnd(i-t)):e.$el.trigger("onSlideClick.lg"))}))},o.prototype.enableDrag=function(){var i=this,o=0,s=0,r=!1,a=!1;i.s.enableDrag&&!i.isTouch&&i.doCss()&&(i.$slide.on("mousedown.lg",function(t){i.$outer.hasClass("lg-zoomed")||(e(t.target).hasClass("lg-object")||e(t.target).hasClass("lg-video-play"))&&(t.preventDefault(),i.lgBusy||(i.manageSwipeClass(),o=t.pageX,r=!0,i.$outer.scrollLeft+=1,i.$outer.scrollLeft-=1,i.$outer.removeClass("lg-grab").addClass("lg-grabbing"),i.$el.trigger("onDragstart.lg")))}),e(t).on("mousemove.lg",function(e){r&&(a=!0,s=e.pageX,i.touchMove(o,s),i.$el.trigger("onDragmove.lg"))}),e(t).on("mouseup.lg",function(t){a?(a=!1,i.touchEnd(s-o),i.$el.trigger("onDragend.lg")):(e(t.target).hasClass("lg-object")||e(t.target).hasClass("lg-video-play"))&&i.$el.trigger("onSlideClick.lg"),r&&(r=!1,i.$outer.removeClass("lg-grabbing").addClass("lg-grab"))}))},o.prototype.manageSwipeClass=function(){var e=this.index+1,t=this.index-1,i=this.$slide.length;this.s.loop&&(0===this.index?t=i-1:this.index===i-1&&(e=0)),this.$slide.removeClass("lg-next-slide lg-prev-slide"),t>-1&&this.$slide.eq(t).addClass("lg-prev-slide"),this.$slide.eq(e).addClass("lg-next-slide")},o.prototype.mousewheel=function(){var e=this;e.$outer.on("mousewheel.lg",function(t){t.deltaY&&(t.deltaY>0?e.goToPrevSlide():e.goToNextSlide(),t.preventDefault())})},o.prototype.closeGallery=function(){var t=this,i=!1;this.$outer.find(".lg-close").on("click.lg",function(){t.destroy()}),t.s.closable&&(t.$outer.on("mousedown.lg",function(t){i=!!(e(t.target).is(".lg-outer")||e(t.target).is(".lg-item ")||e(t.target).is(".lg-img-wrap"))}),t.$outer.on("mouseup.lg",function(o){(e(o.target).is(".lg-outer")||e(o.target).is(".lg-item ")||e(o.target).is(".lg-img-wrap")&&i)&&(t.$outer.hasClass("lg-dragging")||t.destroy())}))},o.prototype.destroy=function(i){var o=this;i||o.$el.trigger("onBeforeClose.lg"),e(t).scrollTop(o.prevScrollTop),i&&(o.s.dynamic||this.$items.off("click.lg click.lgcustom"),e.removeData(o.el,"lightGallery")),this.$el.off(".lg.tm"),e.each(e.fn.lightGallery.modules,function(e){o.modules[e]&&o.modules[e].destroy()}),this.lGalleryOn=!1,clearTimeout(o.hideBartimeout),this.hideBartimeout=!1,e(t).off(".lg"),e("body").removeClass("lg-on lg-from-hash"),o.$outer&&o.$outer.removeClass("lg-visible"),e(".lg-backdrop").removeClass("in"),setTimeout(function(){o.$outer&&o.$outer.remove(),e(".lg-backdrop").remove(),i||o.$el.trigger("onCloseAfter.lg")},o.s.backdropDuration+50)},e.fn.lightGallery=function(t){return this.each(function(){if(e.data(this,"lightGallery"))try{e(this).data("lightGallery").init()}catch(e){console.error("lightGallery has not initiated properly")}else e.data(this,"lightGallery",new o(this,t))})},e.fn.lightGallery.modules={}}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={fullScreen:!0},Fullscreen=function(element){return this.core=$(element).data("lightGallery"),this.$el=$(element),this.core.s=$.extend({},defaults,this.core.s),this.init(),this};Fullscreen.prototype.init=function(){var fullScreen="";if(this.core.s.fullScreen){if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))return;fullScreen='<span class="lg-fullscreen lg-icon"></span>',this.core.$outer.find(".lg-toolbar").append(fullScreen),this.fullScreen()}},Fullscreen.prototype.requestFullscreen=function(){var el=document.documentElement;el.requestFullscreen?el.requestFullscreen():el.msRequestFullscreen?el.msRequestFullscreen():el.mozRequestFullScreen?el.mozRequestFullScreen():el.webkitRequestFullscreen&&el.webkitRequestFullscreen()},Fullscreen.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},Fullscreen.prototype.fullScreen=function(){var _this=this;$(document).on("fullscreenchange.lg webkitfullscreenchange.lg mozfullscreenchange.lg MSFullscreenChange.lg",function(){_this.core.$outer.toggleClass("lg-fullscreen-on")}),this.core.$outer.find(".lg-fullscreen").on("click.lg",function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?_this.exitFullscreen():_this.requestFullscreen()})},Fullscreen.prototype.destroy=function(){this.exitFullscreen(),$(document).off("fullscreenchange.lg webkitfullscreenchange.lg mozfullscreenchange.lg MSFullscreenChange.lg")},$.fn.lightGallery.modules.fullscreen=Fullscreen}(jQuery,window,document),function(e,t){"use strict";var o={thumbnail:!0,animateThumb:!0,currentPagerPosition:"middle",thumbWidth:100,thumbContHeight:100,thumbMargin:5,exThumbImage:!1,showThumbByDefault:!0,toogleThumb:!0,pullCaptionUp:!0,enableThumbDrag:!0,enableThumbSwipe:!0,swipeThreshold:50,loadYoutubeThumbnail:!0,youtubeThumbSize:1,loadVimeoThumbnail:!0,vimeoThumbSize:"thumbnail_small",loadDailymotionThumbnail:!0},r=function(t){return this.core=e(t).data("lightGallery"),this.core.s=e.extend({},o,this.core.s),this.$el=e(t),this.$thumbOuter=null,this.thumbOuterWidth=0,this.thumbTotalWidth=this.core.$items.length*(this.core.s.thumbWidth+this.core.s.thumbMargin),this.thumbIndex=this.core.index,this.left=0,this.init(),this};r.prototype.init=function(){var e=this;this.core.s.thumbnail&&this.core.$items.length>1&&(this.core.s.showThumbByDefault&&setTimeout(function(){e.core.$outer.addClass("lg-thumb-open")},700),this.core.s.pullCaptionUp&&this.core.$outer.addClass("lg-pull-caption-up"),this.build(),this.core.s.animateThumb?(this.core.s.enableThumbDrag&&!this.core.isTouch&&this.core.doCss()&&this.enableThumbDrag(),this.core.s.enableThumbSwipe&&this.core.isTouch&&this.core.doCss()&&this.enableThumbSwipe(),this.thumbClickable=!1):this.thumbClickable=!0,this.toogle(),this.thumbkeyPress())},r.prototype.build=function(){function o(e,t,o){var r,s=a.core.isVideo(e,o)||{},l="";s.youtube||s.vimeo||s.dailymotion?s.youtube?r=a.core.s.loadYoutubeThumbnail?"//img.youtube.com/vi/"+s.youtube[1]+"/"+a.core.s.youtubeThumbSize+".jpg":t:s.vimeo?a.core.s.loadVimeoThumbnail?(r="//i.vimeocdn.com/video/error_"+n+".jpg",l=s.vimeo[1]):r=t:s.dailymotion&&(r=a.core.s.loadDailymotionThumbnail?"//www.dailymotion.com/thumbnail/video/"+s.dailymotion[1]:t):r=t,i+='<div data-vimeo-id="'+l+'" class="lg-thumb-item" style="width:'+a.core.s.thumbWidth+"px; margin-right: "+a.core.s.thumbMargin+'px"><img src="'+r+'" /></div>',l=""}var r,a=this,i="",n="";switch(this.core.s.vimeoThumbSize){case"thumbnail_large":n="640";break;case"thumbnail_medium":n="200x150";break;case"thumbnail_small":n="100x75"}if(a.core.$outer.addClass("lg-has-thumb"),a.core.$outer.find(".lg").append('<div class="lg-thumb-outer"><div class="lg-thumb group"></div></div>'),a.$thumbOuter=a.core.$outer.find(".lg-thumb-outer"),a.thumbOuterWidth=a.$thumbOuter.width(),a.core.s.animateThumb&&a.core.$outer.find(".lg-thumb").css({width:a.thumbTotalWidth+"px",position:"relative"}),this.core.s.animateThumb&&a.$thumbOuter.css("height",a.core.s.thumbContHeight+"px"),a.core.s.dynamic)for(var l=0;l<a.core.s.dynamicEl.length;l++)o(a.core.s.dynamicEl[l].src,a.core.s.dynamicEl[l].thumb,l);else a.core.$items.each(function(t){a.core.s.exThumbImage?o(e(this).attr("href")||e(this).attr("data-src"),e(this).attr(a.core.s.exThumbImage),t):o(e(this).attr("href")||e(this).attr("data-src"),e(this).find("img").attr("src"),t)});a.core.$outer.find(".lg-thumb").html(i),r=a.core.$outer.find(".lg-thumb-item"),r.each(function(){var t=e(this),o=t.attr("data-vimeo-id");o&&e.getJSON("http://www.vimeo.com/api/v2/video/"+o+".json?callback=?",{format:"json"},function(e){t.find("img").attr("src",e[0][a.core.s.vimeoThumbSize])})}),r.eq(a.core.index).addClass("active"),a.core.$el.on("onBeforeSlide.lg.tm",function(){r.removeClass("active"),r.eq(a.core.index).addClass("active")}),r.on("click.lg touchend.lg",function(){var t=e(this);setTimeout(function(){(a.thumbClickable&&!a.core.lgBusy||!a.core.doCss())&&(a.core.index=t.index(),a.core.slide(a.core.index,!1,!0))},50)}),a.core.$el.on("onBeforeSlide.lg.tm",function(){a.animateThumb(a.core.index)}),e(t).on("resize.lg.thumb orientationchange.lg.thumb",function(){setTimeout(function(){a.animateThumb(a.core.index),a.thumbOuterWidth=a.$thumbOuter.width()},200)})},r.prototype.setTranslate=function(e){this.core.$outer.find(".lg-thumb").css({transform:"translate3d(-"+e+"px, 0px, 0px)"})},r.prototype.animateThumb=function(e){var t=this.core.$outer.find(".lg-thumb");if(this.core.s.animateThumb){var o;switch(this.core.s.currentPagerPosition){case"left":o=0;break;case"middle":o=this.thumbOuterWidth/2-this.core.s.thumbWidth/2;break;case"right":o=this.thumbOuterWidth-this.core.s.thumbWidth}this.left=(this.core.s.thumbWidth+this.core.s.thumbMargin)*e-1-o,this.left>this.thumbTotalWidth-this.thumbOuterWidth&&(this.left=this.thumbTotalWidth-this.thumbOuterWidth),this.left<0&&(this.left=0),this.core.lGalleryOn?(t.hasClass("on")||this.core.$outer.find(".lg-thumb").css("transition-duration",this.core.s.speed+"ms"),this.core.doCss()||t.animate({left:-this.left+"px"},this.core.s.speed)):this.core.doCss()||t.css("left",-this.left+"px"),this.setTranslate(this.left)}},r.prototype.enableThumbDrag=function(){var o=this,r=0,a=0,i=!1,n=!1,s=0;o.$thumbOuter.addClass("lg-grab"),o.core.$outer.find(".lg-thumb").on("mousedown.lg.thumb",function(e){o.thumbTotalWidth>o.thumbOuterWidth&&(e.preventDefault(),r=e.pageX,i=!0,o.core.$outer.scrollLeft+=1,o.core.$outer.scrollLeft-=1,o.thumbClickable=!1,o.$thumbOuter.removeClass("lg-grab").addClass("lg-grabbing"))}),e(t).on("mousemove.lg.thumb",function(e){i&&(s=o.left,n=!0,a=e.pageX,o.$thumbOuter.addClass("lg-dragging"),s-=a-r,s>o.thumbTotalWidth-o.thumbOuterWidth&&(s=o.thumbTotalWidth-o.thumbOuterWidth),s<0&&(s=0),o.setTranslate(s))}),e(t).on("mouseup.lg.thumb",function(){n?(n=!1,o.$thumbOuter.removeClass("lg-dragging"),o.left=s,Math.abs(a-r)<o.core.s.swipeThreshold&&(o.thumbClickable=!0)):o.thumbClickable=!0,i&&(i=!1,o.$thumbOuter.removeClass("lg-grabbing").addClass("lg-grab"))})},r.prototype.enableThumbSwipe=function(){var e=this,t=0,o=0,r=!1,a=0;e.core.$outer.find(".lg-thumb").on("touchstart.lg",function(o){e.thumbTotalWidth>e.thumbOuterWidth&&(o.preventDefault(),t=o.originalEvent.targetTouches[0].pageX,e.thumbClickable=!1)}),e.core.$outer.find(".lg-thumb").on("touchmove.lg",function(i){e.thumbTotalWidth>e.thumbOuterWidth&&(i.preventDefault(),o=i.originalEvent.targetTouches[0].pageX,r=!0,e.$thumbOuter.addClass("lg-dragging"),a=e.left,a-=o-t,a>e.thumbTotalWidth-e.thumbOuterWidth&&(a=e.thumbTotalWidth-e.thumbOuterWidth),a<0&&(a=0),e.setTranslate(a))}),e.core.$outer.find(".lg-thumb").on("touchend.lg",function(){e.thumbTotalWidth>e.thumbOuterWidth&&r?(r=!1,e.$thumbOuter.removeClass("lg-dragging"),Math.abs(o-t)<e.core.s.swipeThreshold&&(e.thumbClickable=!0),e.left=a):e.thumbClickable=!0})},r.prototype.toogle=function(){var e=this;e.core.s.toogleThumb&&(e.core.$outer.addClass("lg-can-toggle"),e.$thumbOuter.append('<span class="lg-toogle-thumb lg-icon"></span>'),e.core.$outer.find(".lg-toogle-thumb").on("click.lg",function(){e.core.$outer.toggleClass("lg-thumb-open")}))},r.prototype.thumbkeyPress=function(){var o=this;e(t).on("keydown.lg.thumb",function(e){38===e.keyCode?(e.preventDefault(),o.core.$outer.addClass("lg-thumb-open")):40===e.keyCode&&(e.preventDefault(),o.core.$outer.removeClass("lg-thumb-open"))})},r.prototype.destroy=function(){this.core.s.thumbnail&&this.core.$items.length>1&&(e(t).off("resize.lg.thumb orientationchange.lg.thumb keydown.lg.thumb"),this.$thumbOuter.remove(),this.core.$outer.removeClass("lg-has-thumb"))},e.fn.lightGallery.modules.Thumbnail=r}(jQuery,window,document),Rt3Api.prototype.getHotelInfo=function(){return query("/hotels/details.json",{hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale})},Rt3Api.prototype.getPortalInfo=function(){return query("/portals/"+this.config.portalId+".json",{locale:this.config.defaultLocale,currency:this.config.defaultCurrency})},Rt3Api.prototype.getAllRooms=function(){var self=this,params={rooms:1,hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale},defer=$.Deferred();return this.roomCache?defer.resolve(this.roomCache):query("/hotels/rooms.json",params).then(function(result){self.roomCache=result,defer.resolve(result)}),defer},Rt3Api.prototype.availableRooms=function(searchParams){var defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency};return query("/hotels/roomRateList.json",$.extend(defaultParams,searchParams))},Rt3Api.prototype.getAllAvailableRooms=function(searchParams){var newParams={};if(searchParams)newParams.arrival_date_0=searchParams.arrival_date,newParams.departure_date_0=searchParams.departure_date,newParams.adults_0=searchParams.adults,newParams.children_0=searchParams.children,newParams.rooms=1,delete searchParams.arrival_date,delete searchParams.departure_date,delete searchParams.adults,delete searchParams.children;else{var nextDay,now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),today=now.getFullYear()+"-"+month+"-"+day;nextDay=new Date(today);var tomarrow=new Date(nextDay.setDate(nextDay.getDate()+1)),depart=tomarrow.toISOString().slice(0,10);newParams.arrival_date_0=today,newParams.departure_date_0=depart,newParams.adults_0=2,newParams.children_0=0,newParams.rooms=1}var defaultParams={hotel_id:this.config.hotelId,
-portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,ip_address:sessionStorage.ip_add};return query("/hotels/rooms.json",$.extend(defaultParams,newParams,searchParams))},Rt3Api.prototype.availableRoomsTonight=function(){var nextDay,now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),today=now.getFullYear()+"-"+month+"-"+day;nextDay=new Date(today);var tomarrow=new Date(nextDay.setDate(nextDay.getDate()+1)),depart=tomarrow.toISOString().slice(0,10);return query("/hotels/roomRateList.json",{hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,arrival_date:today,departure_date:depart,adults:2,children:0,rooms:1})},Rt3Api.prototype.getAllSpecialRates=function(){return query("/hotels/special_rates.json",{hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency})},Rt3Api.prototype.getRoomInfo=function(searchParams){var defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency};return query("/hotels/roomDetails.json",$.extend(defaultParams,searchParams))},Rt3Api.prototype.getRateShopping=function(searchParams){var defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,popular_only:!1,num_rates_display:15,client_ip:sessionStorage.ip_add,lowest_rate:null,search_lowest:!0};return query("/hotels/rateshopping.json",$.extend(defaultParams,function(searchParams){var params=searchParams;return params["adults[]"]=searchParams.adults||1,params["children[]"]=searchParams.children||0,params.rooms=searchParams.rooms||1,params}(searchParams)))},Rt3Api.prototype.getBrgInfo=function(searchParams){var self=this,defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,ip_address:sessionStorage.ip_add},params=$.extend(defaultParams,searchParams),defered=$.Deferred();this.getRoomInfo(params).then(function(response){var ratePlans=response.rate_plans;self.getAllRooms().then(function(rooms_response){if(ratePlans){var is_base_room_type=!1;if($.each(rooms_response.rooms,function(key,value){value.code==params.room_id&&value.is_base_room_type&&(is_base_room_type=!0)}),is_base_room_type)self.getRateShopping({arrival_date:searchParams.arrival_date,departure_date:searchParams.departure_date,adults:searchParams.adults,children:searchParams.children}).then(function(rsResponse){if(rsResponse.error_info.error_details.length&&console&&console.error,rsResponse.show_brg){var response={discounted_rate:rsResponse.discounted_rate||rsResponse.original_rate,code:"BRG",rates:rsResponse.rates,avg_brg_discounted_price:rsResponse.discounted_rate,avg_brg_original_price:rsResponse.original_rate,show_brg:!0,discount_threshold_exceeded:rsResponse.discount_threshold_exceeded,dpr_name:rsResponse.dpr_name};defered.resolve(response)}else{var response={discounted_rate:ratePlans[0].average_discounted_nightly_price||ratePlans[0].average_nightly_price,code:ratePlans[0].code,rates:[]};defered.resolve(response)}});else{var response={discounted_rate:ratePlans[0].average_discounted_nightly_price||ratePlans[0].average_nightly_price,code:ratePlans[0].code,rates:[]};defered.resolve(response)}}else{var response={discounted_rate:null,code:null,rates:[]};defered.resolve(response)}})});return defered},Rt3Api.prototype.getOTARates=function(params){var searchParams,startDate,reztripRate,brgFound,nextDay,retResponse={},brg={},defered=$.Deferred(),now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),startDate=now.getFullYear()+"-"+month+"-"+day;return nextDay=new Date(startDate),searchParams={arrival_date:startDate,departure_date:new Date(nextDay.setDate(nextDay.getDate()+1)).toISOString().slice(0,10)},params&&(searchParams=$.extend(searchParams,params)),this.getRateShopping(searchParams).then(function(response){var errors=response.error_info;errors&&errors.error_details.length>0?defered.reject(errors):response.show_brg?(reztripRate="$"+Math.round(response.discounted_rate),response.rates.forEach(function(ota){brg[ota.provider]=ota.rate}),brgFound=response.rates.length>0,retResponse={reztripRate:reztripRate,brg:brg,brgFound:brgFound},defered.resolve(retResponse)):(retResponse={error_info:{error_details:[{error_type:"NOT_ALLOWED",error_messgae:"BRG rates are not allowed to display."}]}},defered.reject(retResponse))}),defered},Rt3Api.prototype.recentBookings=function(timeCutOffMinutes){return query("/ext/recentBookings",{propertyCode:this.config.hotelId,timeCutOffMinutes:timeCutOffMinutes})},Rt3Api.prototype.rateCalendarForToday=function(searchParams){var startDate=(new Date).toISOString().slice(0,10),today=new Date(startDate),endFullDate=new Date(today.setDate(today.getDate()+120)),endDate=endFullDate.toISOString().slice(0,10),defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,start_date:startDate,end_date:endDate,adults:1,children:0,rooms:1,ip_address:sessionStorage.ip_add,lowest_rate:null};return query("/hotels/rate_calendar.json",$.extend(defaultParams,searchParams))},function(){angular.module("rezTrip",[],function($interpolateProvider){$interpolateProvider.startSymbol("[["),$interpolateProvider.endSymbol("]]")}).value("rt3api",new Rt3Api({portalId:"beachterraceinn",hotelId:"CABTI",defaultLocale:"en",defaultCurrency:"USD"})).config(function($locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}).directive("onSearchChanged",function(rt3Search){return{scope:!1,restrict:"A",link:function(scope,element,attrs){scope.$watch("search.params",function(params){params.arrival_date&&params.departure_date&&scope.$eval(attrs.onSearchChanged)},!0),scope.$eval(attrs.onSearchChanged)}}}).controller("roomList",["$scope","rt3Search","rt3Browser","$q","$filter","$http",function($scope,rt3Search,rt3Browser,$q,$filter,$http){$(".roomType").hide(),$scope.selectedCat="",$scope.updateCategory=function(cat){$scope.selectedCat=cat},setTimeout(function(){$(".roomType").show()},1600)}]).controller("roomDetail",["$scope","rt3Search","rt3Browser","$timeout","$filter","$http",function($scope,rt3Search,rt3Browser,$timeout,$filter,$http){setTimeout(function(){$(".loading").fadeOut("slow"),$("#adults").val(1),$("#children").val(0)},2e3)}]).controller("loader",["$scope",function($scope){setTimeout(function(){$(".roomPageContent").css("display","block"),$(".loading").fadeOut("slow")},1200)}]).controller("offerDetail",["$scope","rt3SpecialRates","rt3Browser","$timeout","$filter","$q",function($scope,rt3SpecialRates,rt3Browser,$timeout,$filter,$q){window.onhashchange=function(){window.location.reload()},setTimeout(function(){$(".loading").fadeOut("slow"),$(window).scrollTop(0)},1200)}]).controller("bookingWidget",["$scope","rt3Search","rt3Browser",function($scope,rt3Search,rt3Browser){var self=this;this.arrivalOptions={minDate:0},this.departureOptions={minDate:1},this.chachgeMinDate=function(target){var today=(new Date).getDate();new Date($scope.search.params.arrival_date).getDate(),new Date($scope.search.params.arrival_date).getMonth();if(0==rt3Browser.roomsTonight.length&&$(".price").hide(),"departure"==target){var dept=new Date($scope.search.params.arrival_date),theDay=new Date(dept.setDate(dept.getDate()+1));self.departureOptions.minDate=theDay.getDate()-today+1;var newDay=theDay.toISOString().slice(0,10);$scope.search.params.departure_date=newDay,rt3Browser.getdiff=!1}if("depart"==target){var date1=new Date($scope.search.params.arrival_date),date2=new Date($scope.search.params.departure_date),timeDiff=Math.abs(date2.getTime()-date1.getTime());Math.ceil(timeDiff/864e5)>=2&&(rt3Browser.getdiff=!0)}}}])}(),angular.module("rezTrip").service("rt3HotelInfo",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){function galleryArr(items){for(var arr=[],i=0;i<items.length;i++)arr.push(items[i].thumb_yankee_medium);return arr}var hotelInfo={loaded:!1,galleryImg:[]};return hotelInfo.ready=$q(function(resolve){rt3api.getHotelInfo().then(function(response){$rootScope.$apply(function(){angular.extend(hotelInfo,response),hotelInfo.loaded=!0,hotelInfo.galleryImg=galleryArr(response.photos),resolve(hotelInfo)})})}),hotelInfo}]).service("rt3PortalInfo",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var searchParams={loaded:!1};return searchParams.ready=$q(function(resolve){rt3api.getPortalInfo().then(function(response){$rootScope.$apply(function(){angular.extend(searchParams,response),searchParams.loaded=!0,resolve(searchParams)})})}),searchParams}]).service("rt3Search",["rt3PortalInfo","rt3api","$rootScope",function(rt3PortalInfo,rt3api,$rootScope){function Search(){this.loaded=!1,this.constraints={},this.params={},this.today=today(),prepareConstraintsAndParams(this)}function prepareConstraintsAndParams(self){rt3PortalInfo.ready.then(function(response){angular.extend(self.constraints,extractsConstraints(response)),angular.extend(self.params,extractsParams(response)),self.loaded=!0})}function extractsConstraints(params){return{min_length_of_stay:params.min_length_of_stay,max_length_of_stay:params.max_length_of_stay,numbers_of_rooms:params.numbers_of_rooms,default_number_of_rooms:params.default_number_of_rooms,min_number_of_adults_per_room:params.min_number_of_adults_per_room,max_number_of_adults_per_room:params.max_number_of_adults_per_room,default_number_of_adults_per_room:params.default_number_of_adults_per_room,min_number_of_children_per_room:params.min_number_of_children_per_room,max_number_of_children_per_room:params.max_number_of_children_per_room,min_number_of_guests_per_room:params.min_number_of_guests_per_room,max_number_of_guests_per_room:params.max_number_of_guests_per_room}}function extractsParams(params){return function(params){return{arrival_date:today(),departure_date:today(1),portal_id:rt3api.config.portalId,hotel_id:rt3api.config.hotelId,locale:rt3api.config.defaultLocale,currency:rt3api.config.defaultCurrency,rooms:params.default_number_of_rooms,adults:params.default_number_of_adults_per_room,children:params.min_number_of_children_per_room}}(params)}function today(minLos){var date=new Date,n=minLos||0;return date.getFullYear()+"-"+("0"+(date.getMonth()+1)).slice(-2)+"-"+("0"+(date.getDate()+n)).slice(-2)}return Search.prototype.getParams=function(){var self=this;return{arrival_date:self.params.arrival_date||today(),departure_date:self.params.departure_date||today(1),adults:self.constraints.min_number_of_adults_per_room||1,children:self.params.children||self.constraints.min_number_of_children_per_room||0,rooms:self.params.rooms||self.constraints.default_number_of_rooms||1}},new Search}]).service("rt3Browser",["$rootScope","$q","rt3api","rt3Search",function($rootScope,$q,rt3api,rt3Search){function Browser(){this.loaded=!1,this.roomsTonight=[],this.rooms=[],this.toNigthsRate,this.errors=[],this.tonightErrors=[],this.searchParams={},this.getdiff=!1}Browser.prototype.tonightRate=function(){var self=this;self.isRate=!0,rt3api.getAllAvailableRooms().then(function(response){$rootScope.$applyAsync(function(){self.roomsList=response.rooms,self.tonightErrors=response.error_info.error_details;var roomCategories=response.rooms.map(function(obj){return obj.category.trim()});if(roomCategories=roomCategories.filter(function(v,i){return roomCategories.indexOf(v)==i}),roomCatInReztripOrder=["Courtyard","Partial Ocean View","Poolside","Pool Terrace","Ocean Front"],roomCategories.sort(function(a,b){return roomCatInReztripOrder.indexOf(a)-roomCatInReztripOrder.indexOf(b)}),self.roomCategories=roomCategories,0==self.roomsList.length)self.isRate=!1;else{var roomRate,todayRate={};self.isRate=!1,angular.forEach(self.roomsList,function(room,key){roomRate=room.min_discounted_average_price[0]||room.min_average_price[0],null==room.min_average_price[0]||self.isRate||(self.isRate=!0,self.toNightsRate=Math.round(roomRate)),todayRate=null==roomRate?{todayRate:"Check Availability"}:{todayRate:Math.round(roomRate)},angular.extend(self.roomsList[key],todayRate)})}self.loaded=!0,angular.extend(self,{otaRates:{brgFound:!1}}),$q.when(rt3api.getOTARates()).then(function(response){if(response.brgFound&&Object.keys)for(var len,lastKey;Object.keys(response.brg).length>4;)len=Object.keys(response.brg).length,lastKey=Object.keys(response.brg)[len-1],delete response.brg[lastKey];angular.extend(self,{otaRates:response})},function(response){angular.extend(self,{otaRates:{brgFound:!1}})})})})},Browser.prototype.search=function(params){var date=new Date,self=this;this.loaded=!1,this.searchParams=params||rt3Search.getParams(),this.thisDate=date.getFullYear()+"-"+("0"+(date.getMonth()+1)).slice(-2)+"-"+("0"+date.getDate()).slice(-2),this.searchParams||this.storageContainer?rt3api.getAllAvailableRooms(this.searchParams||this.storageContainer).then(function(response){$rootScope.$apply(function(){if(self.rooms=response.rooms,0==self.rooms.length)self.getRate="Check Availability",$(".-count").css("font-size","23px"),$(".-count").css("line-height","28px"),$(".-count").css("text-align","center");else{var showRate=self.rooms[0].min_discounted_average_price[0]||self.rooms[0].min_average_price[0];null==showRate?(showRate="Check Availability",$(".-count").css("font-size","23px"),$(".-count").css("line-height","28px"),$(".-count").css("text-align","center")):($(".-count").css("font-size","36px"),$(".-count").css("line-height","40px"),$(".-count").css("text-align","left"),showRate=Math.round(showRate)),self.getRate=showRate}self.errors=response.error_info.error_details,self.loaded=!0,self.searchParams=self.searchParams||self.storageContainer})}):rt3api.getAllRooms().then(function(response){$rootScope.$apply(function(){self.rooms=response.rooms,self.errors=response.error_info.error_details,self.loaded=!0})})};var browser=new Browser;return browser.tonightRate(),browser}]).service("rt3SpecialRates",["$rootScope","$q","$location","rt3api","$filter",function($rootScope,$q,$location,rt3api,$filter){function formatRespone(response){return response}var specialRates={loaded:!1,sRdetail:{},locationHash:window.location.hash.substr(1)};return specialRates.ready=$q(function(resolve){rt3api.getAllSpecialRates().then(function(response){$rootScope.$applyAsync(function(){var formatResponseValue,hashName,tmpName;if(formatResponseValue=formatRespone(response),specialRates.locationHash){var specialFound=!1;angular.forEach(response.special_rates,function(value,key){tmpName=$filter("formatNameForLink")(value.rate_plan_name),hashName=$filter("formatNameForLink")(specialRates.locationHash),tmpName==hashName&&(angular.extend(specialRates.sRdetail,value),specialFound=!0)})}angular.extend(specialRates,formatResponseValue),specialRates.loaded=!0,resolve(specialRates)})})}),specialRates}]).service("rt3RoomDetails",["$rootScope","$q","$location","rt3Search","rt3api","$timeout","$filter",function($rootScope,$q,$location,rt3Search,rt3api,$timeout,$filter){function RoomDetails(){loaded=!1,params={},brg={},locationHash=$location.path().substr(1)}RoomDetails.prototype.fetchRoomDetails=function(){var self=this,searchParams=rt3Search.getParams(),roomName=window.location.hash.substr(1);self.prevRoomName="",self.nextRoomName="",$q.when(rt3api.getAllAvailableRooms()).then(function(response){var roomSizeSqm,roomSizeSqft;$.each(response.rooms,function(key,value){if($filter("formatNameForLink")(value.name)==$filter("formatNameForLink")(roomName)){var showRate=value.min_discounted_average_price[0]||value.min_average_price[0];showRate=null==showRate?"Check Availability":Math.round(showRate),angular.extend(self,{todayRate:showRate}),"ft<sup>2</sup>"==value.room_size_units?(roomSizeSqm=value.room_size/10.764,value.room_size_sqm=Math.round(roomSizeSqm)+" m<sup>2</sup>",value.room_size_sqft=value.room_size+"  ft<sup>2</sup>"):"m<sup>2</sup>"==value.room_size_units&&(roomSizeSqft=10.764*value.room_size,value.room_size_sqft=Math.round(roomSizeSqft)+" ft<sup>2</sup>",value.room_size_sqm=value.room_size+" m<sup>2</sup>"),key>0&&(self.prevRoomName=response.rooms[key-1].name),key<response.rooms.length-1&&(self.nextRoomName=response.rooms[key+1].name),angular.extend(self,value),searchParams=$.extend(searchParams,{room_id:value.code}),self.brgLoaded=!1,$q.when(rt3api.getBrgInfo(searchParams)).then(function(response){self.brg=response,self.brgLoaded=!0})}})})};var details=new RoomDetails;return $rootScope.$on("$locationChangeSuccess",function(){details.fetchRoomDetails(),$("body").scrollTop(0)}),$timeout(function(){details.fetchRoomDetails()},0),details}]).service("rt3RecentBookings",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var recentBookings={loaded:!1};return recentBookings.ready=$q(function(resolve){rt3api.recentBookings(2880).then(function(response){$rootScope.$apply(function(){angular.extend(recentBookings,response),recentBookings.loaded=!0,recentBookings=response,resolve(recentBookings)})})}),recentBookings}]).service("rt3RateShopping",["$q","rt3api","rt3Search",function($q,rt3api,rt3Search){function RateShopping(){this.loaded=!1,this.params=rt3Search.getParams(),getRateShopping(this)}function getRateShopping(self){$q.when(rt3api.getRateShopping(self.params)).then(function(response){angular.extend(self,response),this.loaded=!0})}return new RateShopping}]).service("rt3RateCalendar",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var defered=$.Deferred();return rt3api.rateCalendarForToday({}).then(function(response){defered.resolve(response)}),defered}]),angular.module("rezTrip").directive("rt3HotelInfo",["rt3HotelInfo",function(rt3HotelInfo){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3HotelInfo]=rt3HotelInfo}}}]).directive("rt3PortalInfo",["rt3PortalInfo",function(rt3PortalInfo){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3PortalInfo]=rt3PortalInfo}}}]).directive("rt3SearchForm",["rt3Search",function(rt3Search){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3SearchForm]=rt3Search}}}]).directive("rt3RoomsBrowser",["rt3Browser","$rootScope",function(rt3Browser,$rootScope){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RoomsBrowser]=rt3Browser}}}]).directive("rt3SpecialRates",["rt3SpecialRates",function(rt3SpecialRates){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3SpecialRates]=rt3SpecialRates}}}]).directive("rt3RoomDetails",["rt3RoomDetails",function(rt3RoomDetails){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RoomDetails]=rt3RoomDetails}}}]).directive("rt3RecentBookings",["rt3RecentBookings",function(rt3RecentBookings){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RecentBookings]=rt3RecentBookings}}}]).directive("rt3RateShopping",["rt3RateShopping",function(rt3RateShopping){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RateShopping]=rt3RateShopping}}}]).directive("onSearchChanged",function(rt3Search){return{scope:!1,restrict:"A",link:function(scope,element,attrs){scope.$watch("search.params",function(params){params.arrival_date&&params.departure_date&&scope.$eval(attrs.onSearchChanged)},!0),scope.$eval(attrs.onSearchChanged)}}}).directive("rt3RateCalendar",["rt3RateCalendar",function(rt3RateCalendar){return{restrict:"A",scope:!0,link:function(scope,element,attrs){setTimeout(function(){var dayrates,options=$(element).data("options"),isBaseRoom=options.baseroom,checkinEle=options.checkinEle,checkoutEle=options.checkoutEle,apiFunc=isBaseRoom?rt3RateCalendar:"",availability=!0;$.when(apiFunc).then(function(response){response&&(dayrates=[{}],$.each(response.rate_calendar_dates,function(index,value){dayrates[0][value.date]=value.best_available_rate?"$"+Math.round(value.best_available_rate):"NA"}),response.rate_calendar_dates||(availability=!1)),$(element).datepicker("option","beforeShowDay",function(date){var date1=$.datepicker.parseDate("yy-mm-dd",$("#"+checkinEle).val()),date2=$.datepicker.parseDate("yy-mm-dd",$("#"+checkoutEle).val()),title="";return dayrates&&(title=dayrates[0][date.getFullYear()+"-"+(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-"+(date.getDate()<10?"0"+date.getDate():date.getDate())]),title?[!0,date1&&(date.getTime()==date1.getTime()||date2&&date>=date1&&date<=date2)?"dp-highlight":"",title]:[!0,date1&&(date.getTime()==date1.getTime()||date2&&date>=date1&&date<=date2)?"dp-highlight":""]}),$(element).datepicker("option","onSelect",function(dateText,inst){var date1=$.datepicker.parseDate("yy-mm-dd",$("#"+checkinEle).val()),date2=$.datepicker.parseDate("yy-mm-dd",$("#"+checkoutEle).val()),selectedDate=$.datepicker.parseDate("yy-mm-dd",dateText);!date1||date2?($("#"+checkinEle).val(dateText),$("#"+checkoutEle).val("")):selectedDate<date1?($("#"+checkinEle).val($("#"+checkinEle).val()),$("#"+checkoutEle).val(dateText)):$("#"+checkoutEle).val(dateText),$(this).datepicker()}),isBaseRoom&&availability&&$(" .ui-datepicker").after('<div class="middle" style="padding:5px;margin-top:-3rem;margin-bottom:3rem;background-color:#000;color:#fff;font-size:13px;>Standard rates shown. Choose your stay dates to check actual pricing and availability.</div>')})},3300)}}}]),angular.module("rezTrip").filter("isArray",[function(){return function(input){return angular.isArray(input)}}]).filter("formatpolicydescription",function(){return function(text){return text?String(text).replace('["',"<p>").replace('"]',"</p>").replace(","," "):""}}).filter("ampersand",function(){return function(input){return input?input.replace(/&amp;/,"&"):""}}).filter("renderHTMLCorrectly",function($sce){return function(stringToParse){return $sce.trustAsHtml(stringToParse)}}).filter("replaceNewline",function(){return function(value){return value?String(value).replace(/\n+/g,"<br>"):""}}).filter("formatNameForLink",function(){return function(value){var retString=String(value).toLowerCase();return retString=retString.replace(/^\s\s*/,"").replace(/\s\s*$/,""),retString=retString.replace("%","percent"),retString=retString.replace(/[^A-Z0-9]+/gi,"-"),retString=retString.replace(/^--s*/,"").replace(/--*$/,""),value?retString:""}}).filter("range",function(){return function(input,total){total=parseInt(total);for(var i=0;i<total;i++)input.push(i);return input}}).filter("roomOrSuite",function(){return function(value){var retStr,str=String(value).toLowerCase();return retStr=-1!=str.indexOf("suite")?"Suite":"Room",value?retStr:""}}),$(document).ready(function(){function changeHeader(){$(window).width()>991&&($(window).scrollTop()>200?($(".navbar").addClass("shrink-nav"),$(".navbar").css({top:"0px",opacity:"1"}),$("body").css("margin-top","115px")):($(".navbar").removeClass("shrink-nav"),$(".navbar").css({top:"56px",opacity:"1"}),$("body").css("margin-top","0")))}if($("#main").fitVids(),$("#input-13").datepicker(),$("#input-14").datepicker(),$("#input_15").datepicker(),$("#input_16").datepicker(),$("a").smoothScroll({offset:-20}),$(window).on("load resize scroll",function(e){changeHeader()}),$("#view_rates").click(function(){$("#tongihtrates").toggle("slow")}),$("#close").click(function(e){e.preventDefault(),$("#tongihtrates").toggle("hide")}),$(".home-rooms-inner").hide(),setTimeout(function(){$(".home-rooms-inner").show(),$(".room-detail-page .inner-banner").slick({dots:!1,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1}),$(".home-rooms-inner").slick({centerMode:!0,centerPadding:"25%",slidesToShow:1,responsive:[{breakpoint:767,settings:{centerPadding:"10%"},breakpoint:600,settings:{centerPadding:"0%"}}]}),$(".attractions-list,.assets-slide-inner").slick({dots:!1,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:1,autoplay:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:3}},{breakpoint:900,settings:{slidesToShow:2}},{breakpoint:650,settings:{slidesToShow:1,slidesToScroll:1}}]}),$(".caption-price").show()},3100),$(".attractions-list").on("afterChange",function(event,slick,currentSlide,nextSlide){var $slides=$(".attractions-list").slick("getSlick").$slides,title=$slides.eq(currentSlide).data("text");$(".info").html(title)}),$(".filter").on("click",function(){var $this=$(this);if(!$this.hasClass("active")){$(".filter").removeClass("active"),$this.addClass("active");var $filter=$this.data("rel");"all"==$filter?$(".fancybox").attr("data-fancybox-group","gallery").not(":visible").fadeIn():$(".fancybox").fadeOut(0).filter(function(){return $(this).data("filter")==$filter}).attr("data-fancybox-group",$filter).fadeIn(1e3),setTimeout(function(){var lightgallery=$("#lightgallery");lightgallery.length>0&&(lightgallery.data("lightGallery").destroy(!0),$("#lightgallery").lightGallery({selector:".item:visible",counter:!1,thumbnail:!1,share:!1}))},1e3)}}),$("#lightgallery").lightGallery({selector:".item",counter:!1,thumbnail:!1,share:!1}),$(".dropdown").hover(function(){$(".dropdown-menu",this).stop().fadeIn("fast")},function(){$(".dropdown-menu",this).stop().fadeOut("fast")}),function(){var myLatLng={lat:33.159199,lng:-117.354283},stylemap=[{elementType:"geometry",stylers:[{color:"#f4eee6"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f4eee6"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#dff2fa"}]}];if(document.getElementById("map")){var map=new google.maps.Map(document.getElementById("map"),{zoom:15,styles:stylemap,center:new google.maps.LatLng(33.159199,-117.354283),scrollwheel:!1}),marker=new google.maps.Marker({position:myLatLng,map:map,title:"Beach Terrace inn",icon:"/assets/images/logo-icon.png"});google.maps.event.addListener(marker,"click",function(){window.location.href="https://goo.gl/maps/oAgfrCrWcb52"})}}(),$("#datepicker-arrival").length>0){$("#datepicker-arrival").datepicker({dateFormat:"yy-mm-dd",altFormat:"yy-mm-dd",minDate:0,onSelect:function(date){var date2=$("#datepicker-arrival").datepicker("getDate"),date2_min=$("#datepicker-arrival").datepicker("getDate");date2.setDate(date2.getDate()+1),$("#datepicker-departure").datepicker("setDate",date2),$("#datepicker-departure").datepicker("option","minDate",date2_min)}}),$("#datepicker-departure").datepicker({dateFormat:"yy-mm-dd",altFormat:"yy-mm-dd",onClose:function(){var dt1=$("#datepicker-arrival").datepicker("getDate");if($("#datepicker-departure").datepicker("getDate")<=dt1){var minDate=$("#datepicker-departure").datepicker("option","minDate");$("#datepicker-departure").datepicker("setDate",minDate)}}});var todayDate=new Date;$("#datepicker-arrival").datepicker("setDate",todayDate);var nextDay=new Date(todayDate.setDate(todayDate.getDate()+1));$("#datepicker-departure").datepicker("setDate",nextDay),$(".datepickerIn").click(function(){$("#datepicker-arrival").datepicker("show")}),$(".datepickerOut").click(function(){$("#datepicker-departure").datepicker("show")})}setTimeout(function(){$("#roomsselector").change(function(){$(".extra-adult-children").html("");var adult_children=$(".adult-children").first().html(),length=parseInt($(this).val());for(i=1;i<length;i++)$(".extra-adult-children").append(adult_children)}),$("#roomsselector").trigger("change"),$("#bookingWidgetRoomsModal").on("hide.bs.modal",function(e){$(".reztrip-extra-adults-children").html("");var adults,children,adultChildrenHtml="",totAdults=0,totChildren=0,length=parseInt($("#roomsselector").val()),adultsInputs=$("#bookingWidgetRoomsModal select[name='adults[]']"),childInput=$("#bookingWidgetRoomsModal select[name='children[]']");for(i=0;i<length;i++)adults=$(adultsInputs[i]).val(),children=$(childInput[i]).val(),totAdults+=parseInt(adults),totChildren+=parseInt(children),adultChildrenHtml="<input type='hidden' name='adults[]' value='"+$(adultsInputs[i]).val()+"' />",adultChildrenHtml+="<input type='hidden' name='children[]' value='"+$(childInput[i]).val()+"' />",$(".reztrip-extra-adults-children").append(adultChildrenHtml);$("#frmBookingWidget .children-holder input").val(totChildren),$("#frmBookingWidget .adults-holder input").val(totAdults),$("#frmBookingWidget .rooms-holder input").val(length)})},500)}),function($){function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))}var u_source=getParameterByName("utm_source"),u_medium=getParameterByName("utm_medium"),u_campaign=getParameterByName("utm_campaign"),u_term=getParameterByName("utm_term"),u_content=getParameterByName("utm_content");""!=u_source&&(sessionStorage.utm_source=u_source),""!=u_medium&&(sessionStorage.utm_medium=u_medium),""!=u_campaign&&(sessionStorage.utm_campaign=u_campaign),""!=u_term&&(sessionStorage.utm_term=u_term),""!=u_content&&(sessionStorage.utm_content=u_content),$(document).on("click","a",function(){var source=sessionStorage.utm_source,medium=sessionStorage.utm_medium,campaign=sessionStorage.utm_campaign,term=sessionStorage.utm_term,content=sessionStorage.utm_content,currentUrl=window.location.origin,this_href=$(this).attr("href");this_href&&(source||medium||campaign||term||content)&&(-1!=this_href.indexOf("?")?this_href+="&":this_href+="?",null!=source&&""!=source&&-1==this_href.indexOf("utm_source")&&(this_href=this_href+"utm_source="+source+"&"),null!=medium&&""!=medium&&-1==this_href.indexOf("utm_medium")&&(this_href=this_href+"utm_medium="+medium+"&"),null!=campaign&&""!=campaign&&-1==this_href.indexOf("utm_campaign")&&(this_href=this_href+"utm_campaign="+campaign+"&"),null!=term&&""!=term&&-1==this_href.indexOf("utm_term")&&(this_href=this_href+"utm_term="+term+"&"),null!=content&&""!=content&&-1==this_href.indexOf("utm_content")&&(this_href=this_href+"utm_content="+content),-1==this.href.indexOf(currentUrl)&&$(this).attr("href",this_href))}),$(document).on("submit","form",function(){var source=($(this).attr("action"),sessionStorage.utm_source),medium=sessionStorage.utm_medium,campaign=sessionStorage.utm_campaign,term=sessionStorage.utm_term,content=sessionStorage.utm_content,utmEl="";null!=source&&""!=source&&0==$("input[name='utm_source']").length&&(utmEl="<input type='hidden' name='utm_source' value='"+escape(source)+"'>"),null!=medium&&""!=medium&&0==$("input[name='utm_medium']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_medium' value='"+escape(medium)+"'>"),null!=campaign&&""!=campaign&&0==$("input[name='utm_campaign']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_campaign' value='"+escape(campaign)+"'>"),
-null!=term&&""!=term&&0==$("input[name='utm_term']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_term' value='"+escape(term)+"'>"),null!=content&&""!=content&&0==$("input[name='utm_content']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_content' value='"+escape(content)+"'>"),""!=utmEl&&(utmEl=$(utmEl),$(this).prepend(utmEl))})}($);
\ No newline at end of file
+portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,ip_address:sessionStorage.ip_add};return query("/hotels/rooms.json",$.extend(defaultParams,newParams,searchParams))},Rt3Api.prototype.availableRoomsTonight=function(){var nextDay,now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),today=now.getFullYear()+"-"+month+"-"+day;nextDay=new Date(today);var tomarrow=new Date(nextDay.setDate(nextDay.getDate()+1)),depart=tomarrow.toISOString().slice(0,10);return query("/hotels/roomRateList.json",{hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,arrival_date:today,departure_date:depart,adults:2,children:0,rooms:1})},Rt3Api.prototype.getAllSpecialRates=function(){return query("/hotels/special_rates.json",{hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency})},Rt3Api.prototype.getRoomInfo=function(searchParams){var defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency};return query("/hotels/roomDetails.json",$.extend(defaultParams,searchParams))},Rt3Api.prototype.getRateShopping=function(searchParams){var defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,popular_only:!1,num_rates_display:15,client_ip:sessionStorage.ip_add,lowest_rate:null,search_lowest:!0};return query("/hotels/rateshopping.json",$.extend(defaultParams,function(searchParams){var params=searchParams;return params["adults[]"]=searchParams.adults||1,params["children[]"]=searchParams.children||0,params.rooms=searchParams.rooms||1,params}(searchParams)))},Rt3Api.prototype.getBrgInfo=function(searchParams){var self=this,defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,ip_address:sessionStorage.ip_add},params=$.extend(defaultParams,searchParams),defered=$.Deferred();this.getRoomInfo(params).then(function(response){var ratePlans=response.rate_plans;self.getAllRooms().then(function(rooms_response){if(ratePlans){var is_base_room_type=!1;if($.each(rooms_response.rooms,function(key,value){value.code==params.room_id&&value.is_base_room_type&&(is_base_room_type=!0)}),is_base_room_type)self.getRateShopping({arrival_date:searchParams.arrival_date,departure_date:searchParams.departure_date,adults:searchParams.adults,children:searchParams.children}).then(function(rsResponse){if(rsResponse.error_info.error_details.length&&console&&console.error,rsResponse.show_brg){var response={discounted_rate:rsResponse.discounted_rate||rsResponse.original_rate,code:"BRG",rates:rsResponse.rates,avg_brg_discounted_price:rsResponse.discounted_rate,avg_brg_original_price:rsResponse.original_rate,show_brg:!0,discount_threshold_exceeded:rsResponse.discount_threshold_exceeded,dpr_name:rsResponse.dpr_name};defered.resolve(response)}else{var response={discounted_rate:ratePlans[0].average_discounted_nightly_price||ratePlans[0].average_nightly_price,code:ratePlans[0].code,rates:[]};defered.resolve(response)}});else{var response={discounted_rate:ratePlans[0].average_discounted_nightly_price||ratePlans[0].average_nightly_price,code:ratePlans[0].code,rates:[]};defered.resolve(response)}}else{var response={discounted_rate:null,code:null,rates:[]};defered.resolve(response)}})});return defered},Rt3Api.prototype.getOTARates=function(params){var searchParams,startDate,reztripRate,brgFound,nextDay,retResponse={},brg={},defered=$.Deferred(),now=new Date,day=("0"+now.getDate()).slice(-2),month=("0"+(now.getMonth()+1)).slice(-2),startDate=now.getFullYear()+"-"+month+"-"+day;return nextDay=new Date(startDate),searchParams={arrival_date:startDate,departure_date:new Date(nextDay.setDate(nextDay.getDate()+1)).toISOString().slice(0,10)},params&&(searchParams=$.extend(searchParams,params)),this.getRateShopping(searchParams).then(function(response){var errors=response.error_info;errors&&errors.error_details.length>0?defered.reject(errors):response.show_brg?(reztripRate="$"+Math.round(response.discounted_rate),response.rates.forEach(function(ota){brg[ota.provider]=ota.rate}),brgFound=response.rates.length>0,retResponse={reztripRate:reztripRate,brg:brg,brgFound:brgFound},defered.resolve(retResponse)):(retResponse={error_info:{error_details:[{error_type:"NOT_ALLOWED",error_messgae:"BRG rates are not allowed to display."}]}},defered.reject(retResponse))}),defered},Rt3Api.prototype.recentBookings=function(timeCutOffMinutes){return query("/ext/recentBookings",{propertyCode:this.config.hotelId,timeCutOffMinutes:timeCutOffMinutes})},Rt3Api.prototype.rateCalendarForToday=function(searchParams){var startDate=(new Date).toISOString().slice(0,10),today=new Date(startDate),endFullDate=new Date(today.setDate(today.getDate()+120)),endDate=endFullDate.toISOString().slice(0,10),defaultParams={hotel_id:this.config.hotelId,portal_id:this.config.portalId,locale:this.config.defaultLocale,currency:this.config.defaultCurrency,start_date:startDate,end_date:endDate,adults:1,children:0,rooms:1,ip_address:sessionStorage.ip_add,lowest_rate:null};return query("/hotels/rate_calendar.json",$.extend(defaultParams,searchParams))},function(){angular.module("rezTrip",[],function($interpolateProvider){$interpolateProvider.startSymbol("[["),$interpolateProvider.endSymbol("]]")}).value("rt3api",new Rt3Api({portalId:"hoteldivasf",hotelId:"SFOHDI",defaultLocale:"en",defaultCurrency:"USD"})).config(function($locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}).directive("onSearchChanged",function(rt3Search){return{scope:!1,restrict:"A",link:function(scope,element,attrs){scope.$watch("search.params",function(params){params.arrival_date&&params.departure_date&&scope.$eval(attrs.onSearchChanged)},!0),scope.$eval(attrs.onSearchChanged)}}}).controller("roomList",["$scope","rt3Search","rt3Browser","$q","$filter","$http",function($scope,rt3Search,rt3Browser,$q,$filter,$http){$(".roomType").hide(),$scope.selectedCat="",$scope.updateCategory=function(cat){$scope.selectedCat=cat},setTimeout(function(){$(".roomType").show()},1600)}]).controller("roomDetail",["$scope","rt3Search","rt3Browser","$timeout","$filter","$http",function($scope,rt3Search,rt3Browser,$timeout,$filter,$http){setTimeout(function(){$(".loading").fadeOut("slow"),$("#adults").val(1),$("#children").val(0)},2e3)}]).controller("loader",["$scope",function($scope){setTimeout(function(){$(".roomPageContent").css("display","block"),$(".loading").fadeOut("slow")},1200)}]).controller("offerDetail",["$scope","rt3SpecialRates","rt3Browser","$timeout","$filter","$q",function($scope,rt3SpecialRates,rt3Browser,$timeout,$filter,$q){window.onhashchange=function(){window.location.reload()},setTimeout(function(){$(".loading").fadeOut("slow"),$(window).scrollTop(0)},1200)}]).controller("bookingWidget",["$scope","rt3Search","rt3Browser",function($scope,rt3Search,rt3Browser){var self=this;this.arrivalOptions={minDate:0},this.departureOptions={minDate:1},this.chachgeMinDate=function(target){var today=(new Date).getDate();new Date($scope.search.params.arrival_date).getDate(),new Date($scope.search.params.arrival_date).getMonth();if(0==rt3Browser.roomsTonight.length&&$(".price").hide(),"departure"==target){var dept=new Date($scope.search.params.arrival_date),theDay=new Date(dept.setDate(dept.getDate()+1));self.departureOptions.minDate=theDay.getDate()-today+1;var newDay=theDay.toISOString().slice(0,10);$scope.search.params.departure_date=newDay,rt3Browser.getdiff=!1}if("depart"==target){var date1=new Date($scope.search.params.arrival_date),date2=new Date($scope.search.params.departure_date),timeDiff=Math.abs(date2.getTime()-date1.getTime());Math.ceil(timeDiff/864e5)>=2&&(rt3Browser.getdiff=!0)}}}])}(),angular.module("rezTrip").service("rt3HotelInfo",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){function galleryArr(items){for(var arr=[],i=0;i<items.length;i++)arr.push(items[i].thumb_yankee_medium);return arr}var hotelInfo={loaded:!1,galleryImg:[]};return hotelInfo.ready=$q(function(resolve){rt3api.getHotelInfo().then(function(response){$rootScope.$apply(function(){angular.extend(hotelInfo,response),hotelInfo.loaded=!0,hotelInfo.galleryImg=galleryArr(response.photos),resolve(hotelInfo)})})}),hotelInfo}]).service("rt3PortalInfo",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var searchParams={loaded:!1};return searchParams.ready=$q(function(resolve){rt3api.getPortalInfo().then(function(response){$rootScope.$apply(function(){angular.extend(searchParams,response),searchParams.loaded=!0,resolve(searchParams)})})}),searchParams}]).service("rt3Search",["rt3PortalInfo","rt3api","$rootScope",function(rt3PortalInfo,rt3api,$rootScope){function Search(){this.loaded=!1,this.constraints={},this.params={},this.today=today(),prepareConstraintsAndParams(this)}function prepareConstraintsAndParams(self){rt3PortalInfo.ready.then(function(response){angular.extend(self.constraints,extractsConstraints(response)),angular.extend(self.params,extractsParams(response)),self.loaded=!0})}function extractsConstraints(params){return{min_length_of_stay:params.min_length_of_stay,max_length_of_stay:params.max_length_of_stay,numbers_of_rooms:params.numbers_of_rooms,default_number_of_rooms:params.default_number_of_rooms,min_number_of_adults_per_room:params.min_number_of_adults_per_room,max_number_of_adults_per_room:params.max_number_of_adults_per_room,default_number_of_adults_per_room:params.default_number_of_adults_per_room,min_number_of_children_per_room:params.min_number_of_children_per_room,max_number_of_children_per_room:params.max_number_of_children_per_room,min_number_of_guests_per_room:params.min_number_of_guests_per_room,max_number_of_guests_per_room:params.max_number_of_guests_per_room}}function extractsParams(params){return function(params){return{arrival_date:today(),departure_date:today(1),portal_id:rt3api.config.portalId,hotel_id:rt3api.config.hotelId,locale:rt3api.config.defaultLocale,currency:rt3api.config.defaultCurrency,rooms:params.default_number_of_rooms,adults:params.default_number_of_adults_per_room,children:params.min_number_of_children_per_room}}(params)}function today(minLos){var date=new Date,n=minLos||0;return date.getFullYear()+"-"+("0"+(date.getMonth()+1)).slice(-2)+"-"+("0"+(date.getDate()+n)).slice(-2)}return Search.prototype.getParams=function(){var self=this;return{arrival_date:self.params.arrival_date||today(),departure_date:self.params.departure_date||today(1),adults:self.constraints.min_number_of_adults_per_room||1,children:self.params.children||self.constraints.min_number_of_children_per_room||0,rooms:self.params.rooms||self.constraints.default_number_of_rooms||1}},new Search}]).service("rt3Browser",["$rootScope","$q","rt3api","rt3Search",function($rootScope,$q,rt3api,rt3Search){function Browser(){this.loaded=!1,this.roomsTonight=[],this.rooms=[],this.toNigthsRate,this.errors=[],this.tonightErrors=[],this.searchParams={},this.getdiff=!1}Browser.prototype.tonightRate=function(){var self=this;self.isRate=!0,rt3api.getAllAvailableRooms().then(function(response){$rootScope.$applyAsync(function(){self.roomsList=response.rooms,self.tonightErrors=response.error_info.error_details;var roomCategories=response.rooms.map(function(obj){return obj.category.trim()});if(roomCategories=roomCategories.filter(function(v,i){return roomCategories.indexOf(v)==i}),roomCatInReztripOrder=["Courtyard","Partial Ocean View","Poolside","Pool Terrace","Ocean Front"],roomCategories.sort(function(a,b){return roomCatInReztripOrder.indexOf(a)-roomCatInReztripOrder.indexOf(b)}),self.roomCategories=roomCategories,0==self.roomsList.length)self.isRate=!1;else{var roomRate,todayRate={};self.isRate=!1,angular.forEach(self.roomsList,function(room,key){roomRate=room.min_discounted_average_price[0]||room.min_average_price[0],null==room.min_average_price[0]||self.isRate||(self.isRate=!0,self.toNightsRate=Math.round(roomRate)),todayRate=null==roomRate?{todayRate:"Check Availability"}:{todayRate:Math.round(roomRate)},angular.extend(self.roomsList[key],todayRate)})}self.loaded=!0,angular.extend(self,{otaRates:{brgFound:!1}}),$q.when(rt3api.getOTARates()).then(function(response){if(response.brgFound){if(Object.keys)for(var len,lastKey;Object.keys(response.brg).length>4;)len=Object.keys(response.brg).length,lastKey=Object.keys(response.brg)[len-1],delete response.brg[lastKey];var lowestOTARate=Math.min.apply(Math,Object.keys(response.brg).map(function(key,index){return response.brg[key]}));response.lowestOTARate=lowestOTARate}angular.extend(self,{otaRates:response})},function(response){angular.extend(self,{otaRates:{brgFound:!1}})})})})},Browser.prototype.search=function(params){var date=new Date,self=this;this.loaded=!1,this.searchParams=params||rt3Search.getParams(),this.thisDate=date.getFullYear()+"-"+("0"+(date.getMonth()+1)).slice(-2)+"-"+("0"+date.getDate()).slice(-2),this.searchParams||this.storageContainer?rt3api.getAllAvailableRooms(this.searchParams||this.storageContainer).then(function(response){$rootScope.$apply(function(){if(self.rooms=response.rooms,0==self.rooms.length)self.getRate="Check Availability",$(".-count").css("font-size","23px"),$(".-count").css("line-height","28px"),$(".-count").css("text-align","center");else{var showRate=self.rooms[0].min_discounted_average_price[0]||self.rooms[0].min_average_price[0];null==showRate?(showRate="Check Availability",$(".-count").css("font-size","23px"),$(".-count").css("line-height","28px"),$(".-count").css("text-align","center")):($(".-count").css("font-size","36px"),$(".-count").css("line-height","40px"),$(".-count").css("text-align","left"),showRate=Math.round(showRate)),self.getRate=showRate}self.errors=response.error_info.error_details,self.loaded=!0,self.searchParams=self.searchParams||self.storageContainer})}):rt3api.getAllRooms().then(function(response){$rootScope.$apply(function(){self.rooms=response.rooms,self.errors=response.error_info.error_details,self.loaded=!0})})};var browser=new Browser;return browser.tonightRate(),browser}]).service("rt3SpecialRates",["$rootScope","$q","$location","rt3api","$filter",function($rootScope,$q,$location,rt3api,$filter){function formatRespone(response){return response}var specialRates={loaded:!1,sRdetail:{},locationHash:window.location.hash.substr(1)};return specialRates.ready=$q(function(resolve){rt3api.getAllSpecialRates().then(function(response){$rootScope.$applyAsync(function(){var formatResponseValue,hashName,tmpName;if(formatResponseValue=formatRespone(response),specialRates.locationHash){var specialFound=!1;angular.forEach(response.special_rates,function(value,key){tmpName=$filter("formatNameForLink")(value.rate_plan_name),hashName=$filter("formatNameForLink")(specialRates.locationHash),tmpName==hashName&&(angular.extend(specialRates.sRdetail,value),specialFound=!0)})}angular.extend(specialRates,formatResponseValue),specialRates.loaded=!0,resolve(specialRates)})})}),specialRates}]).service("rt3RoomDetails",["$rootScope","$q","$location","rt3Search","rt3api","$timeout","$filter",function($rootScope,$q,$location,rt3Search,rt3api,$timeout,$filter){function RoomDetails(){loaded=!1,params={},brg={},locationHash=$location.path().substr(1)}RoomDetails.prototype.fetchRoomDetails=function(){var self=this,searchParams=rt3Search.getParams(),roomName=window.location.hash.substr(1);self.prevRoomName="",self.nextRoomName="",$q.when(rt3api.getAllAvailableRooms()).then(function(response){var roomSizeSqm,roomSizeSqft;$.each(response.rooms,function(key,value){if($filter("formatNameForLink")(value.name)==$filter("formatNameForLink")(roomName)){var showRate=value.min_discounted_average_price[0]||value.min_average_price[0];showRate=null==showRate?"Check Availability":Math.round(showRate),angular.extend(self,{todayRate:showRate}),"ft<sup>2</sup>"==value.room_size_units?(roomSizeSqm=value.room_size/10.764,value.room_size_sqm=Math.round(roomSizeSqm)+" m<sup>2</sup>",value.room_size_sqft=value.room_size+"  ft<sup>2</sup>"):"m<sup>2</sup>"==value.room_size_units&&(roomSizeSqft=10.764*value.room_size,value.room_size_sqft=Math.round(roomSizeSqft)+" ft<sup>2</sup>",value.room_size_sqm=value.room_size+" m<sup>2</sup>"),key>0&&(self.prevRoomName=response.rooms[key-1].name),key<response.rooms.length-1&&(self.nextRoomName=response.rooms[key+1].name),angular.extend(self,value),searchParams=$.extend(searchParams,{room_id:value.code}),self.brgLoaded=!1,$q.when(rt3api.getBrgInfo(searchParams)).then(function(response){self.brg=response,self.brgLoaded=!0})}})})};var details=new RoomDetails;return $rootScope.$on("$locationChangeSuccess",function(){details.fetchRoomDetails(),$("body").scrollTop(0)}),$timeout(function(){details.fetchRoomDetails()},0),details}]).service("rt3RecentBookings",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var recentBookings={loaded:!1};return recentBookings.ready=$q(function(resolve){rt3api.recentBookings(2880).then(function(response){$rootScope.$apply(function(){angular.extend(recentBookings,response),recentBookings.loaded=!0,recentBookings=response,resolve(recentBookings)})})}),recentBookings}]).service("rt3RateShopping",["$q","rt3api","rt3Search",function($q,rt3api,rt3Search){function RateShopping(){this.loaded=!1,this.params=rt3Search.getParams(),getRateShopping(this)}function getRateShopping(self){$q.when(rt3api.getRateShopping(self.params)).then(function(response){angular.extend(self,response),this.loaded=!0})}return new RateShopping}]).service("rt3RateCalendar",["$rootScope","$q","rt3api",function($rootScope,$q,rt3api){var defered=$.Deferred();return rt3api.rateCalendarForToday({}).then(function(response){defered.resolve(response)}),defered}]),angular.module("rezTrip").directive("rt3HotelInfo",["rt3HotelInfo",function(rt3HotelInfo){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3HotelInfo]=rt3HotelInfo}}}]).directive("rt3PortalInfo",["rt3PortalInfo",function(rt3PortalInfo){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3PortalInfo]=rt3PortalInfo}}}]).directive("rt3SearchForm",["rt3Search",function(rt3Search){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3SearchForm]=rt3Search}}}]).directive("rt3RoomsBrowser",["rt3Browser","$rootScope",function(rt3Browser,$rootScope){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RoomsBrowser]=rt3Browser}}}]).directive("rt3SpecialRates",["rt3SpecialRates",function(rt3SpecialRates){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3SpecialRates]=rt3SpecialRates}}}]).directive("rt3RoomDetails",["rt3RoomDetails",function(rt3RoomDetails){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RoomDetails]=rt3RoomDetails}}}]).directive("rt3RecentBookings",["rt3RecentBookings",function(rt3RecentBookings){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RecentBookings]=rt3RecentBookings}}}]).directive("rt3RateShopping",["rt3RateShopping",function(rt3RateShopping){return{restrict:"A",scope:!0,link:function(scope,element,attrs){scope[attrs.rt3RateShopping]=rt3RateShopping}}}]).directive("onSearchChanged",function(rt3Search){return{scope:!1,restrict:"A",link:function(scope,element,attrs){scope.$watch("search.params",function(params){params.arrival_date&&params.departure_date&&scope.$eval(attrs.onSearchChanged)},!0),scope.$eval(attrs.onSearchChanged)}}}).directive("rt3RateCalendar",["rt3RateCalendar",function(rt3RateCalendar){return{restrict:"A",scope:!0,link:function(scope,element,attrs){setTimeout(function(){var dayrates,options=$(element).data("options"),isBaseRoom=options.baseroom,checkinEle=options.checkinEle,checkoutEle=options.checkoutEle,apiFunc=isBaseRoom?rt3RateCalendar:"",availability=!0;$.when(apiFunc).then(function(response){response&&(dayrates=[{}],$.each(response.rate_calendar_dates,function(index,value){dayrates[0][value.date]=value.best_available_rate?"$"+Math.round(value.best_available_rate):"NA"}),response.rate_calendar_dates||(availability=!1)),$(element).datepicker("option","beforeShowDay",function(date){var date1=$.datepicker.parseDate("yy-mm-dd",$("#"+checkinEle).val()),date2=$.datepicker.parseDate("yy-mm-dd",$("#"+checkoutEle).val()),title="";return dayrates&&(title=dayrates[0][date.getFullYear()+"-"+(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-"+(date.getDate()<10?"0"+date.getDate():date.getDate())]),title?[!0,date1&&(date.getTime()==date1.getTime()||date2&&date>=date1&&date<=date2)?"dp-highlight":"",title]:[!0,date1&&(date.getTime()==date1.getTime()||date2&&date>=date1&&date<=date2)?"dp-highlight":""]}),$(element).datepicker("option","onSelect",function(dateText,inst){var date1=$.datepicker.parseDate("yy-mm-dd",$("#"+checkinEle).val()),date2=$.datepicker.parseDate("yy-mm-dd",$("#"+checkoutEle).val()),selectedDate=$.datepicker.parseDate("yy-mm-dd",dateText);!date1||date2?($("#"+checkinEle).val(dateText),$("#"+checkoutEle).val("")):selectedDate<date1?($("#"+checkinEle).val($("#"+checkinEle).val()),$("#"+checkoutEle).val(dateText)):$("#"+checkoutEle).val(dateText),$(this).datepicker()}),isBaseRoom&&availability&&$(" .ui-datepicker").after('<div class="middle" style="padding:5px;margin-top:-3rem;margin-bottom:3rem;background-color:#000;color:#fff;font-size:13px;>Standard rates shown. Choose your stay dates to check actual pricing and availability.</div>')})},3300)}}}]),angular.module("rezTrip").filter("isArray",[function(){return function(input){return angular.isArray(input)}}]).filter("formatpolicydescription",function(){return function(text){return text?String(text).replace('["',"<p>").replace('"]',"</p>").replace(","," "):""}}).filter("ampersand",function(){return function(input){return input?input.replace(/&amp;/,"&"):""}}).filter("renderHTMLCorrectly",function($sce){return function(stringToParse){return $sce.trustAsHtml(stringToParse)}}).filter("replaceNewline",function(){return function(value){return value?String(value).replace(/\n+/g,"<br>"):""}}).filter("formatNameForLink",function(){return function(value){var retString=String(value).toLowerCase();return retString=retString.replace(/^\s\s*/,"").replace(/\s\s*$/,""),retString=retString.replace("%","percent"),retString=retString.replace(/[^A-Z0-9]+/gi,"-"),retString=retString.replace(/^--s*/,"").replace(/--*$/,""),value?retString:""}}).filter("range",function(){return function(input,total){total=parseInt(total);for(var i=0;i<total;i++)input.push(i);return input}}).filter("roomOrSuite",function(){return function(value){var retStr,str=String(value).toLowerCase();return retStr=-1!=str.indexOf("suite")?"Suite":"Room",value?retStr:""}}),$(document).ready(function(){function changeHeader(){$(window).width()>991&&($(window).scrollTop()>200?($(".navbar").addClass("shrink-nav"),$(".navbar").css({top:"0px",opacity:"1"}),$("body").css("margin-top","115px")):($(".navbar").removeClass("shrink-nav"),$(".navbar").css({top:"56px",opacity:"1"}),$("body").css("margin-top","0")))}if($("#main").fitVids(),$("#input-13").datepicker(),$("#input-14").datepicker(),$("#input_15").datepicker(),$("#input_16").datepicker(),$("a").smoothScroll({offset:-20}),$(window).on("load resize scroll",function(e){changeHeader()}),$("#view_rates").click(function(){$("#tongihtrates").toggle("slow")}),$("#close").click(function(e){e.preventDefault(),$("#tongihtrates").toggle("hide")}),$(".home-rooms-inner").hide(),setTimeout(function(){$(".home-rooms-inner").show(),$(".room-detail-page .inner-banner").slick({dots:!1,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1}),$(".home-rooms-inner").slick({centerMode:!0,centerPadding:"25%",slidesToShow:1,responsive:[{breakpoint:767,settings:{centerPadding:"10%"},breakpoint:600,settings:{centerPadding:"0%"}}]}),$(".attractions-list,.assets-slide-inner").slick({dots:!1,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:1,autoplay:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:3}},{breakpoint:900,settings:{slidesToShow:2}},{breakpoint:650,settings:{slidesToShow:1,slidesToScroll:1}}]}),$(".scarcity-price, .brg-price").show()},3100),$(".attractions-list").on("afterChange",function(event,slick,currentSlide,nextSlide){var $slides=$(".attractions-list").slick("getSlick").$slides,title=$slides.eq(currentSlide).data("text");$(".info").html(title)}),$(".filter").on("click",function(){var $this=$(this);if(!$this.hasClass("active")){$(".filter").removeClass("active"),$this.addClass("active");var $filter=$this.data("rel");"all"==$filter?$(".fancybox").attr("data-fancybox-group","gallery").not(":visible").fadeIn():$(".fancybox").fadeOut(0).filter(function(){return $(this).data("filter")==$filter}).attr("data-fancybox-group",$filter).fadeIn(1e3),setTimeout(function(){var lightgallery=$("#lightgallery");lightgallery.length>0&&(lightgallery.data("lightGallery").destroy(!0),$("#lightgallery").lightGallery({selector:".item:visible",counter:!1,thumbnail:!1,share:!1}))},1e3)}}),$("#lightgallery").lightGallery({selector:".item",counter:!1,thumbnail:!1,share:!1}),$(".dropdown").hover(function(){$(".dropdown-menu",this).stop().fadeIn("fast")},function(){$(".dropdown-menu",this).stop().fadeOut("fast")}),function(){var myLatLng={lat:33.159199,lng:-117.354283},stylemap=[{elementType:"geometry",stylers:[{color:"#f4eee6"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f4eee6"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#dff2fa"}]}];if(document.getElementById("map")){var map=new google.maps.Map(document.getElementById("map"),{zoom:15,styles:stylemap,center:new google.maps.LatLng(33.159199,-117.354283),scrollwheel:!1}),marker=new google.maps.Marker({position:myLatLng,map:map,title:"Beach Terrace inn",icon:"/assets/images/logo-icon.png"});google.maps.event.addListener(marker,"click",function(){window.location.href="https://goo.gl/maps/oAgfrCrWcb52"})}}(),$("#datepicker-arrival").length>0){$("#datepicker-arrival").datepicker({dateFormat:"yy-mm-dd",altFormat:"yy-mm-dd",minDate:0,onSelect:function(date){var date2=$("#datepicker-arrival").datepicker("getDate"),date2_min=$("#datepicker-arrival").datepicker("getDate");date2.setDate(date2.getDate()+1),$("#datepicker-departure").datepicker("setDate",date2),$("#datepicker-departure").datepicker("option","minDate",date2_min)}}),$("#datepicker-departure").datepicker({dateFormat:"yy-mm-dd",altFormat:"yy-mm-dd",onClose:function(){var dt1=$("#datepicker-arrival").datepicker("getDate");if($("#datepicker-departure").datepicker("getDate")<=dt1){var minDate=$("#datepicker-departure").datepicker("option","minDate");$("#datepicker-departure").datepicker("setDate",minDate)}}});var todayDate=new Date;$("#datepicker-arrival").datepicker("setDate",todayDate);var nextDay=new Date(todayDate.setDate(todayDate.getDate()+1));$("#datepicker-departure").datepicker("setDate",nextDay),$(".datepickerIn").click(function(){$("#datepicker-arrival").datepicker("show")}),$(".datepickerOut").click(function(){$("#datepicker-departure").datepicker("show")})}setTimeout(function(){$("#roomsselector").change(function(){$(".extra-adult-children").html("");var adult_children=$(".adult-children").first().html(),length=parseInt($(this).val());for(i=1;i<length;i++)$(".extra-adult-children").append(adult_children)}),$("#roomsselector").trigger("change"),$("#bookingWidgetRoomsModal").on("hide.bs.modal",function(e){$(".reztrip-extra-adults-children").html("");var adults,children,adultChildrenHtml="",totAdults=0,totChildren=0,length=parseInt($("#roomsselector").val()),adultsInputs=$("#bookingWidgetRoomsModal select[name='adults[]']"),childInput=$("#bookingWidgetRoomsModal select[name='children[]']");for(i=0;i<length;i++)adults=$(adultsInputs[i]).val(),children=$(childInput[i]).val(),totAdults+=parseInt(adults),totChildren+=parseInt(children),adultChildrenHtml="<input type='hidden' name='adults[]' value='"+$(adultsInputs[i]).val()+"' />",adultChildrenHtml+="<input type='hidden' name='children[]' value='"+$(childInput[i]).val()+"' />",$(".reztrip-extra-adults-children").append(adultChildrenHtml);$("#frmBookingWidget .children-holder input").val(totChildren),$("#frmBookingWidget .adults-holder input").val(totAdults),$("#frmBookingWidget .rooms-holder input").val(length)})},500)}),function($){function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))}var u_source=getParameterByName("utm_source"),u_medium=getParameterByName("utm_medium"),u_campaign=getParameterByName("utm_campaign"),u_term=getParameterByName("utm_term"),u_content=getParameterByName("utm_content");""!=u_source&&(sessionStorage.utm_source=u_source),""!=u_medium&&(sessionStorage.utm_medium=u_medium),""!=u_campaign&&(sessionStorage.utm_campaign=u_campaign),""!=u_term&&(sessionStorage.utm_term=u_term),""!=u_content&&(sessionStorage.utm_content=u_content),$(document).on("click","a",function(){var source=sessionStorage.utm_source,medium=sessionStorage.utm_medium,campaign=sessionStorage.utm_campaign,term=sessionStorage.utm_term,content=sessionStorage.utm_content,currentUrl=window.location.origin,this_href=$(this).attr("href");this_href&&(source||medium||campaign||term||content)&&(-1!=this_href.indexOf("?")?this_href+="&":this_href+="?",null!=source&&""!=source&&-1==this_href.indexOf("utm_source")&&(this_href=this_href+"utm_source="+source+"&"),null!=medium&&""!=medium&&-1==this_href.indexOf("utm_medium")&&(this_href=this_href+"utm_medium="+medium+"&"),null!=campaign&&""!=campaign&&-1==this_href.indexOf("utm_campaign")&&(this_href=this_href+"utm_campaign="+campaign+"&"),null!=term&&""!=term&&-1==this_href.indexOf("utm_term")&&(this_href=this_href+"utm_term="+term+"&"),null!=content&&""!=content&&-1==this_href.indexOf("utm_content")&&(this_href=this_href+"utm_content="+content),-1==this.href.indexOf(currentUrl)&&$(this).attr("href",this_href))}),$(document).on("submit","form",function(){var source=($(this).attr("action"),sessionStorage.utm_source),medium=sessionStorage.utm_medium,campaign=sessionStorage.utm_campaign,term=sessionStorage.utm_term,content=sessionStorage.utm_content,utmEl="";null!=source&&""!=source&&0==$("input[name='utm_source']").length&&(utmEl="<input type='hidden' name='utm_source' value='"+escape(source)+"'>"),null!=medium&&""!=medium&&0==$("input[name='utm_medium']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_medium' value='"+escape(medium)+"'>"),
+null!=campaign&&""!=campaign&&0==$("input[name='utm_campaign']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_campaign' value='"+escape(campaign)+"'>"),null!=term&&""!=term&&0==$("input[name='utm_term']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_term' value='"+escape(term)+"'>"),null!=content&&""!=content&&0==$("input[name='utm_content']").length&&(utmEl=utmEl+"<input type='hidden' name='utm_content' value='"+escape(content)+"'>"),""!=utmEl&&(utmEl=$(utmEl),$(this).prepend(utmEl))})}($);
\ No newline at end of file
diff --git a/assets/js/rez-trip.js b/assets/js/rez-trip.js
index 7ba36bd..8c4ac20 100644
--- a/assets/js/rez-trip.js
+++ b/assets/js/rez-trip.js
@@ -5,8 +5,8 @@
       $interpolateProvider.endSymbol(']]');
     })
     .value('rt3api', new Rt3Api({
-      portalId: 'beachterraceinn',
-      hotelId: 'CABTI',
+      portalId: 'hoteldivasf',
+      hotelId: 'SFOHDI',
       defaultLocale: 'en',
       defaultCurrency: 'USD'
     }))
diff --git a/assets/js/rt3-services.js b/assets/js/rt3-services.js
index 17f23a4..8f4c27b 100644
--- a/assets/js/rt3-services.js
+++ b/assets/js/rt3-services.js
@@ -229,7 +229,8 @@ angular.module('rezTrip')
                       }
 
                   }
-
+                  var lowestOTARate = Math.min.apply(Math, Object.keys(response.brg).map(function(key, index){return response.brg[key];}));
+                  response.lowestOTARate = lowestOTARate;
                 }
                 angular.extend(self , {'otaRates' : response});
             }, function(response){
diff --git a/index.html b/index.html
index dcd32bd..193ad2f 100644
--- a/index.html
+++ b/index.html
@@ -14,7 +14,28 @@ permalink:
         <a href="http://beachterraceinn.reztrip.com/">Book Direct & Save<span>△</span></a>
       </div>
     </div>
-    <div class="caption-price" ng-show="recentBookings.totalBookings > 5"> <span class="price-holder"><span>[[ recentBookings.totalBookings ]]</span>People booked our hotel in the last 2 days</span></div>
+    <div class="homeBannerWidget">
+      <div class="brg-price" ng-show="browser.isRate" >
+         <div class="best-rate-ota" ng-show ="browser.otaRates.brgFound && browser.otaRates.lowestOTARate >= browser.toNightsRate" >
+            <div class="boxes">
+              <div class="brg-tonight-rate ">
+                <p>Best Price Available</p>
+                <h4>Tonight's Rate <a href="{{site.reztripUrl}}search" class="homeTonightRate" ><span class="price">$[[browser.toNightsRate]]</span></a></h4>
+              </div>
+              <div class="ota-list" >
+                <ul>
+                <li ng-repeat = "(key, value) in browser.otaRates.brg" ng-show="browser.toNightsRate <= value">[[key]] <span>$[[value]]</span></li>
+                </ul>
+              </div>
+            </div>
+          </div>
+
+      </div>
+      <div class="scarcity-price" rt3-recent-bookings="recentBookings">
+        <span class="price-holder" ng-show="recentBookings.totalBookings > 5"><span>[[ recentBookings.totalBookings ]]</span>People booked our hotel in the last 2 days</span>
+        <span class="price-holder tonight" ng-show="(!browser.otaRates.brgFound && browser.isRate) || (browser.otaRates.brgFound &&  browser.toNightsRate > browser.otaRates.lowestOTARate )"><a href="{{site.reztripUrl}}search" class="homeTonightRate" ><span class="tonightPrice">$[[ browser.toNightsRate ]]</span></a>Tonight’s Rate</span>
+      </div>
+    </div>
   </div>
 </section>
 <!-- hero image slider end-->
